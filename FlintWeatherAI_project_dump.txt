================================================================================
                         PROJECT CODE DUMP: FlintWeatherAI
================================================================================

Project Name: FlintWeatherAI
Project Root: /data/data/com.termux/files/home/FlintWeatherAI
Generated: 2025-11-17 13:18:36
Generated by: Universal Project Dumper v2.0

================================================================================
                              TABLE OF CONTENTS
================================================================================

1. Project File Structure (Tree View)
2. Project Statistics
3. All Code Files (with full content)

================================================================================

================================================================================
                           1. PROJECT FILE STRUCTURE (Tree View)
================================================================================

.
â”œâ”€â”€ FlintWeatherAI_project_dump.txt
â”œâ”€â”€ app
â”‚Â Â  â”œâ”€â”€ main.py
â”‚Â Â  â””â”€â”€ main.py.backup2
â”œâ”€â”€ config
â”‚Â Â  â”œâ”€â”€ __init__.py
â”‚Â Â  â””â”€â”€ config.py
â”œâ”€â”€ docs
â”‚Â Â  â”œâ”€â”€ css
â”‚Â Â  â”‚Â Â  â””â”€â”€ style.css
â”‚Â Â  â”œâ”€â”€ images
â”‚Â Â  â”œâ”€â”€ index.html
â”‚Â Â  â””â”€â”€ js
â”‚Â Â      â””â”€â”€ app.js
â”œâ”€â”€ generate_project_dump.sh
â”œâ”€â”€ logs
â”‚Â Â  â”œâ”€â”€ errors.log
â”‚Â Â  â””â”€â”€ overall.log
â”œâ”€â”€ manifest.json
â”œâ”€â”€ render.yaml
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ service-worker.js
â”œâ”€â”€ setup_logging.py
â”œâ”€â”€ start_server.sh
â”œâ”€â”€ static
â”‚Â Â  â”œâ”€â”€ css
â”‚Â Â  â”‚Â Â  â””â”€â”€ style.css
â”‚Â Â  â”œâ”€â”€ images
â”‚Â Â  â””â”€â”€ js
â”‚Â Â      â””â”€â”€ app.js
â”œâ”€â”€ templates
â”‚Â Â  â””â”€â”€ index.html
â”œâ”€â”€ test_gemini_api.py
â”œâ”€â”€ test_imports.py
â”œâ”€â”€ tmp
â””â”€â”€ utils
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ cache.py
    â”œâ”€â”€ free_ai_apis.py
    â”œâ”€â”€ free_weather_apis.py
    â””â”€â”€ weather.py

15 directories, 27 files

================================================================================
                              2. PROJECT STATISTICS
================================================================================

File Count by Extension:
  .py files:    11
  .js files:    3
  .html files:  2
  .css files:   2
  Total files:  112

================================================================================
                           3. ALL CODE FILES (Full Content)
================================================================================

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FILE: app/main.py
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

import os
import sys

PROJECT_ROOT = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
if PROJECT_ROOT not in sys.path:
    sys.path.insert(0, PROJECT_ROOT)

print(f"Project root: {PROJECT_ROOT}")

try:
    from config.config import get_config
    from utils.cache import ThreadSafeLRUCache
    from utils.weather import WeatherUtils
    from utils.free_weather_apis import FreeWeatherAPIs
    from utils.free_ai_apis import FreeAIAPIs
    print("All modules imported successfully")
except ImportError as e:
    print(f"Import failed: {e}")
    sys.exit(1)

from flask import Flask, request, jsonify, send_from_directory
from flask_cors import CORS
from functools import wraps
import requests
import json
from datetime import datetime, timedelta
import logging
from logging.handlers import RotatingFileHandler
import time
import random
import threading
from typing import Optional, Dict, List

app = Flask(__name__, static_folder="../static", template_folder="../templates")
CORS(app)

os.makedirs("logs", exist_ok=True)

# Detailed formatter for comprehensive logging
detailed_formatter = logging.Formatter('%(asctime)s | %(levelname)-8s | %(funcName)s:%(lineno)d | %(message)s')

# Main comprehensive log - everything
overall_handler = RotatingFileHandler("logs/overall.log", maxBytes=20*1024*1024, backupCount=5)
overall_handler.setFormatter(detailed_formatter)
overall_handler.setLevel(logging.DEBUG)

# Error log
error_handler = RotatingFileHandler("logs/errors.log", maxBytes=10*1024*1024, backupCount=3)
error_handler.setFormatter(detailed_formatter)
error_handler.setLevel(logging.ERROR)

# Console handler
console_handler = logging.StreamHandler()
console_handler.setFormatter(logging.Formatter('%(levelname)s | %(message)s'))
console_handler.setLevel(logging.INFO)

logger = logging.getLogger(__name__)
logger.setLevel(logging.DEBUG)
logger.addHandler(overall_handler)
logger.addHandler(error_handler)
logger.addHandler(console_handler)

# Also log all requests
logging.getLogger().addHandler(overall_handler)

config = get_config()
app.config['SECRET_KEY'] = config.SECRET_KEY

weather_cache = ThreadSafeLRUCache(max_size=config.MAX_CACHE_SIZE)
location_cache = ThreadSafeLRUCache(max_size=config.MAX_CACHE_SIZE)

gemini_enabled = config.USE_GEMINI

class SmartRateLimiter:
    def __init__(self):
        self.last_request = {}
        self.lock = threading.Lock()
    
    def wait_if_needed(self, api_name: str, min_interval: float):
        with self.lock:
            last = self.last_request.get(api_name, 0)
            elapsed = time.time() - last
            if elapsed < min_interval:
                time.sleep(min_interval - elapsed)
            self.last_request[api_name] = time.time()

rate_limiter = SmartRateLimiter()
# Gemini Request Tracker for Free Tier limits
class GeminiRequestTracker:
    def __init__(self):
        self.minute_requests = []
        self.daily_requests = 0
        self.last_reset = datetime.now()
        self.lock = threading.Lock()
    
    def can_make_request(self):
        with self.lock:
            now = datetime.now()
            if now.date() != self.last_reset.date():
                self.daily_requests = 0
                self.last_reset = now
            cutoff = now.timestamp() - 60
            self.minute_requests = [t for t in self.minute_requests if t > cutoff]
            if len(self.minute_requests) >= config.GEMINI_MAX_REQUESTS_PER_MINUTE:
                return False, "minute"
            if self.daily_requests >= config.GEMINI_MAX_REQUESTS_PER_DAY:
                return False, "daily"
            return True, None
    
    def record_request(self):
        with self.lock:
            now = datetime.now()
            self.minute_requests.append(now.timestamp())
            self.daily_requests += 1

gemini_tracker = GeminiRequestTracker()


def cache_key(lat: float, lon: float) -> str:
    return f"weather_{lat}_{lon}".replace(".", "_")

def validate_coordinates(lat: float, lon: float) -> bool:
    try:
        lat = float(lat)
        lon = float(lon)
        return (-90 <= lat <= 90) and (-180 <= lon <= 180)
    except:
        return False

def sanitize_input(text: str, max_length: int = 200) -> str:
    if not isinstance(text, str):
        return ""
    text = text.replace("<", "").replace(">", "").replace('"', "")
    text = text.replace("'", "").replace("&", "").replace("\\", "")
    return text.strip()[:max_length]

def get_gemini_weather(location_info: Dict) -> Optional[Dict]:
    global gemini_enabled
    if not gemini_enabled:
        return None
    try:
        rate_limiter.wait_if_needed('gemini', config.GEMINI_RATE_LIMIT_DELAY)
        prompt = f"""Weather for {location_info.get('city')} ({location_info.get('latitude')}, {location_info.get('longitude')}).
Return ONLY JSON:
{{"condition": "Clear/Cloudy/etc", "temperature_celsius": 25.0, "feels_like_celsius": 24.0, "humidity_percent": 65, "wind_speed_kmh": 15.0, "description": "brief", "alerts": ["tip1"]}}"""
        url = f"{config.GEMINI_API_URL}?key={config.GEMINI_API_KEY}"
        payload = {"contents": [{"parts": [{"text": prompt}]}], "generationConfig": {"temperature": 0.5, "maxOutputTokens": 300}}
        response = requests.post(url, json=payload, timeout=10)
        if response.status_code == 429:
            logger.warning("Gemini rate limit, disabling")
            gemini_enabled = False
            return None
        response.raise_for_status()
        data = response.json()
        if 'candidates' in data:
            text = data['candidates'][0]['content']['parts'][0]['text']
            start = text.find('{')
            end = text.rfind('}') + 1
            if start != -1 and end > start:
                weather_data = json.loads(text[start:end])
                weather_data.update({"source": "Gemini AI", "is_real_data": False, "timestamp": datetime.now().isoformat()})
                logger.info("Gemini weather OK")
                return weather_data
    except Exception as e:
        logger.debug(f"Gemini error: {e}")
    return None

def get_location_details(lat: float, lon: float) -> Optional[Dict]:
    if not validate_coordinates(lat, lon):
        return None
    cache_k = cache_key(lat, lon)
    cached = location_cache.get(cache_k)
    if cached:
        return cached
    try:
        rate_limiter.wait_if_needed('nominatim', 1.0)
        url = f"https://nominatim.openstreetmap.org/reverse"
        params = {'format': 'json', 'lat': lat, 'lon': lon, 'zoom': 18, 'addressdetails': 1}
        headers = {'User-Agent': config.NOMINATIM_USER_AGENT}
        response = requests.get(url, params=params, headers=headers, timeout=10)
        response.raise_for_status()
        data = response.json()
        address = data.get('address', {})
        result = {
            'locality': address.get('suburb') or address.get('neighbourhood') or 'Unknown',
            'city': address.get('city') or address.get('town') or address.get('village') or 'Unknown City',
            'region': address.get('state', ''),
            'country': address.get('country', 'Unknown'),
            'display_name': data.get('display_name', ''),
            'latitude': lat,
            'longitude': lon
        }
        location_cache.set(cache_k, result, ttl=3600)
        return result
    except Exception as e:
        logger.error(f"Geocoding error: {e}")
        return None

def search_location(query: str) -> List[Dict]:
    query = sanitize_input(query)
    if not query:
        return []
    try:
        rate_limiter.wait_if_needed('nominatim', 1.0)
        url = "https://nominatim.openstreetmap.org/search"
        params = {'format': 'json', 'q': query, 'limit': 5, 'addressdetails': 1}
        headers = {'User-Agent': config.NOMINATIM_USER_AGENT}
        response = requests.get(url, params=params, headers=headers, timeout=10)
        response.raise_for_status()
        results = response.json()
        locations = []
        for result in results:
            address = result.get('address', {})
            locations.append({
                'display_name': result.get('display_name', ''),
                'latitude': float(result.get('lat', 0)),
                'longitude': float(result.get('lon', 0)),
                'city': address.get('city') or address.get('town') or address.get('village', ''),
                'country': address.get('country', '')
            })
        return locations
    except Exception as e:
        logger.error(f"Search error: {e}")
        return []

def get_weather_tips(temp, condition, uv, wind, humidity) -> List[str]:
    tips = []
    if temp is not None:
        if temp >= 35:
            tips.append("Extreme heat! Stay indoors.")
        elif temp >= 30:
            tips.append("Very hot! Stay hydrated.")
        elif temp <= 0:
            tips.append("Freezing! Bundle up.")
        elif temp <= 10:
            tips.append("Cold. Wear warm layers.")
    if condition:
        cond = condition.lower()
        if "rain" in cond:
            tips.append("Rain expected. Bring umbrella!")
        if "storm" in cond:
            tips.append("Storm warning! Stay indoors.")
        if "snow" in cond:
            tips.append("Snow! Drive carefully.")
    if uv and uv >= 6:
        tips.append(f"High UV! Use sunscreen.")
    if wind and wind >= 40:
        tips.append("Strong winds!")
    if humidity and humidity >= 80:
        tips.append("Very humid.")
    return tips if tips else ["Weather looks good!"]

def get_weather_data(location_info: Dict) -> Dict:
    cache_k = cache_key(location_info['latitude'], location_info['longitude'])
    cached = weather_cache.get(cache_k)
    if cached:
        logger.info("Using cached weather")
        return cached
    
    gemini_weather = get_gemini_weather(location_info)
    if gemini_weather:
        weather_data = build_weather_response(gemini_weather, location_info)
        weather_data["weather_tips"].insert(0, "AI-powered from Gemini")
        weather_cache.set(cache_k, weather_data, ttl=1800)
        return weather_data
    
    free_weather = FreeWeatherAPIs.get_weather(
        location_info['latitude'],
        location_info['longitude'],
        config.WEATHER_API_KEY
    )
    weather_data = build_weather_response(free_weather, location_info)
    if free_weather.get('is_mock_data'):
        weather_data["weather_tips"].insert(0, "Simulated data")
    else:
        weather_data["weather_tips"].insert(0, f"From {free_weather.get('source')}")
    ttl = 1800 if free_weather.get('is_mock_data') else 3600
    weather_cache.set(cache_k, weather_data, ttl=ttl)
    return weather_data

def build_weather_response(current_weather: Dict, location_info: Dict) -> Dict:
    temp = current_weather.get('temperature_celsius', 0)
    return {
        "current_weather": current_weather,
        "forecast": {
            "today": f"{current_weather.get('condition', 'Unknown')}, High: {temp + 2} C",
            "tomorrow": f"Similar, High: {temp + random.randint(-2, 2)} C",
            "day_after": f"Partly {current_weather.get('condition', 'Unknown')}, High: {temp} C"
        },
        "sun_times": {"sunrise": "06:30 AM", "sunset": "06:45 PM"},
        "moon_phase": random.choice(["New Moon", "First Quarter", "Full Moon", "Last Quarter"]),
        "location": location_info,
        "weather_tips": get_weather_tips(
            temp,
            current_weather.get('condition'),
            current_weather.get('uv_index'),
            current_weather.get('wind_speed_kmh'),
            current_weather.get('humidity_percent')
        )
    }

def get_chatbot_response(message: str, weather_data: Dict) -> str:
    message = sanitize_input(message, 500)
    if not message:
        return "Please ask a question about the weather!"
    location = weather_data.get('location', {})
    current = weather_data.get('current_weather', {})
    forecast = weather_data.get('forecast', {})
    city = location.get('city', 'your location')
    country = location.get('country', '')
    temp = current.get('temperature_celsius', 0)
    condition = current.get('condition', 'unknown')
    humidity = current.get('humidity_percent', 0)
    wind = current.get('wind_speed_kmh', 0)
    feels_like = current.get('feels_like_celsius', temp)
    if gemini_enabled:
        can_request, limit_type = gemini_tracker.can_make_request()
        if not can_request:
            if limit_type == "minute":
                logger.info("Minute limit reached, waiting 8 seconds...")
                time.sleep(8)
                can_request, _ = gemini_tracker.can_make_request()
            if not can_request:
                logger.warning(f"Gemini {limit_type} limit still exceeded")
                return f"I am currently at my API limit. Current weather in {city}: {condition}, {temp} degrees C. Wind: {wind} km/h, Humidity: {humidity}%. Ask me again in a moment!"
        try:
            rate_limiter.wait_if_needed('gemini_chat', config.GEMINI_RATE_LIMIT_DELAY)
            cache_k = f"chat_{city}_{message[:50]}"
            cached = weather_cache.get(cache_k)
            if cached:
                logger.info("Using cached chat response")
                return cached
            context = f"""You are a helpful weather assistant. Current weather data for {city}, {country}:
- Temperature: {temp} degrees Celsius (feels like {feels_like} C)
- Condition: {condition}
- Humidity: {humidity} percent
- Wind: {wind} km/h
- Today forecast: {forecast.get('today', 'N/A')}
- Tomorrow forecast: {forecast.get('tomorrow', 'N/A')}

User question: {message}

Provide a natural, conversational response in 2-4 complete sentences. Include specific data from above. Finish your thoughts completely."""
            url = f"{config.GEMINI_API_URL}?key={config.GEMINI_API_KEY}"
            payload = {"contents": [{"parts": [{"text": context}]}], "generationConfig": {"temperature": 0.7, "maxOutputTokens": 300, "topP": 0.9}}
            response = requests.post(url, json=payload, timeout=10)
            if response.status_code == 429:
                logger.warning("Gemini API returned 429, waiting 10 seconds...")
                time.sleep(10)
                return f"API is busy right now. But I can tell you: {city} weather is {condition}, {temp} degrees C. Try asking again!"
            response.raise_for_status()
            data = response.json()
            if 'candidates' in data and len(data['candidates']) > 0:
                try:
                    text = data['candidates'][0]['content']['parts'][0]['text']
                    logger.info("Gemini chat success")
                    gemini_tracker.record_request()
                    weather_cache.set(cache_k, text, ttl=config.GEMINI_CACHE_TTL)
                    return text.strip()
                except (KeyError, IndexError) as e:
                    logger.error(f"Gemini parse error: {e}")
            logger.warning("No valid response from Gemini")
        except Exception as e:
            logger.error(f"Gemini error: {e}")
    return FreeAIAPIs.get_chat_response(message, weather_data)

def handle_errors(f):
    @wraps(f)
    def decorated(*args, **kwargs):
        try:
            return f(*args, **kwargs)
        except ValueError as e:
            logger.error(f"Validation: {e}")
            return jsonify({"error": str(e)}), 400
        except Exception as e:
            logger.error(f"Error in {f.__name__}: {e}", exc_info=True)
            return jsonify({"error": "Internal error"}), 500
    return decorated

@app.route('/')
def index():
    return send_from_directory('../templates', 'index.html')

@app.route('/manifest.json')
def manifest():
    return send_from_directory('..', 'manifest.json')

@app.route('/service-worker.js')
def service_worker():
    return send_from_directory('..', 'service-worker.js')

@app.route('/api/reverse-geocode', methods=['POST'])
@handle_errors
def reverse_geocode():
    data = request.get_json()
    if not data:
        raise ValueError("No data")
    lat = float(data.get('latitude'))
    lon = float(data.get('longitude'))
    if not validate_coordinates(lat, lon):
        raise ValueError("Invalid coordinates")
    location = get_location_details(lat, lon)
    if not location:
        raise ValueError("Location failed")
    return jsonify(location)

@app.route('/api/search-location', methods=['POST'])
@handle_errors
def search_location_route():
    data = request.get_json()
    query = data.get('query', '').strip()
    if not query:
        raise ValueError("Query required")
    locations = search_location(query)
    return jsonify({"results": locations})

@app.route('/api/weather', methods=['POST'])
@handle_errors
def get_weather():
    data = request.get_json()
    if not data:
        raise ValueError("No data")
    lat = float(data.get('latitude'))
    lon = float(data.get('longitude'))
    if not validate_coordinates(lat, lon):
        raise ValueError("Invalid coordinates")
    location_info = get_location_details(lat, lon)
    if not location_info:
        location_info = {'latitude': lat, 'longitude': lon, 'locality': 'Unknown', 'city': 'Unknown', 'region': '', 'country': 'Unknown'}
    weather = get_weather_data(location_info)
    return jsonify(weather)

@app.route('/api/hourly', methods=['POST'])
@app.route('/api/hourly', methods=['POST'])
@handle_errors
def get_hourly():
    data = request.get_json()
    lat = float(data.get('latitude'))
    lon = float(data.get('longitude'))
    
    logger.info(f"Hourly forecast requested for: {lat}, {lon}")
    
    if not validate_coordinates(lat, lon):
        raise ValueError("Invalid coordinates")
    
    # Try WeatherAPI.com for real hourly data
    try:
        url = "http://api.weatherapi.com/v1/forecast.json"
        params = {
            'key': config.WEATHER_API_KEY,
            'q': f"{lat},{lon}",
            'days': 1,
            'aqi': 'no',
            'alerts': 'no'
        }
        
        logger.debug(f"Requesting hourly forecast from WeatherAPI: {params['q']}")
        response = requests.get(url, params=params, timeout=10)
        
        logger.debug(f"WeatherAPI hourly response status: {response.status_code}")
        
        if response.status_code == 200:
            api_data = response.json()
            forecast_day = api_data.get('forecast', {}).get('forecastday', [])
            
            if forecast_day and len(forecast_day) > 0:
                forecast_hours = forecast_day[0].get('hour', [])
                
                if forecast_hours:
                    hourly = []
                    for hour_data in forecast_hours:
                        time_str = hour_data.get('time', '').split()[-1] if hour_data.get('time') else '00:00'
                        hourly.append({
                            'hour': time_str,
                            'temperature_celsius': round(hour_data.get('temp_c', 20), 1),
                            'precipitation_chance': int(hour_data.get('chance_of_rain', 0)),
                            'condition': hour_data.get('condition', {}).get('text', 'Clear'),
                            'humidity': hour_data.get('humidity', 50),
                            'wind_kph': round(hour_data.get('wind_kph', 0), 1)
                        })
                    
                    logger.info(f"Returning {len(hourly)} hours of real forecast data")
                    return jsonify({"hourly_forecast": hourly})
        
        logger.warning(f"WeatherAPI returned {response.status_code}: {response.text[:200]}")
    
    except requests.exceptions.Timeout:
        logger.error("WeatherAPI timeout for hourly forecast")
    except requests.exceptions.RequestException as e:
        logger.error(f"WeatherAPI request error: {e}")
    except Exception as e:
        logger.error(f"Unexpected error in hourly forecast: {e}", exc_info=True)
    
    # Fallback to realistic mock data
    logger.warning("Using fallback mock hourly data")
    hourly = []
    current_hour = datetime.now().hour
    base_temp = 21
    
    for i in range(24):
        hour_num = (current_hour + i) % 24
        # Temperature curve: cooler at night, warmer at 2-3 PM
        temp_variation = -5 * abs(hour_num - 14) / 14 + 3
        temp = base_temp + temp_variation + random.uniform(-1, 1)
        
        hourly.append({
            'hour': f"{hour_num:02d}:00",
            'temperature_celsius': round(temp, 1),
            'precipitation_chance': random.randint(0, 30),
            'condition': random.choice(['Clear', 'Partly Cloudy', 'Cloudy'])
        })
    
    return jsonify({"hourly_forecast": hourly})


@app.route('/api/forecast', methods=['POST'])
@handle_errors
def get_forecast():
    data = request.get_json()
    lat = float(data.get('latitude'))
    lon = float(data.get('longitude'))
    
    logger.info(f"7-day forecast requested for: {lat}, {lon}")
    
    if not validate_coordinates(lat, lon):
        raise ValueError("Invalid coordinates")
    
    try:
        url = "http://api.weatherapi.com/v1/forecast.json"
        params = {
            'key': config.WEATHER_API_KEY,
            'q': f"{lat},{lon}",
            'days': 7,
            'aqi': 'yes',
            'alerts': 'yes'
        }
        
        logger.debug(f"Requesting 7-day forecast from WeatherAPI")
        response = requests.get(url, params=params, timeout=10)
        
        if response.status_code == 200:
            api_data = response.json()
            forecast_days = api_data.get('forecast', {}).get('forecastday', [])
            
            if forecast_days:
                days = []
                day_names = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']
                
                for day_data in forecast_days:
                    date_obj = datetime.strptime(day_data.get('date', ''), '%Y-%m-%d')
                    day_name = day_names[date_obj.weekday()]
                    day_info = day_data.get('day', {})
                    
                    days.append({
                        'day': day_name,
                        'date': day_data.get('date'),
                        'max_temp_c': round(day_info.get('maxtemp_c', 25), 1),
                        'min_temp_c': round(day_info.get('mintemp_c', 15), 1),
                        'condition': day_info.get('condition', {}).get('text', 'Clear'),
                        'icon': day_info.get('condition', {}).get('icon', ''),
                        'rain_chance': int(day_info.get('daily_chance_of_rain', 0)),
                        'snow_chance': int(day_info.get('daily_chance_of_snow', 0)),
                        'avg_humidity': int(day_info.get('avghumidity', 50)),
                        'max_wind_kph': round(day_info.get('maxwind_kph', 10), 1)
                    })
                
                # Get AQI data
                current = api_data.get('current', {})
                air_quality = current.get('air_quality', {})
                
                aqi_data = {
                    'us_epa_index': air_quality.get('us-epa-index', 1),
                    'gb_defra_index': air_quality.get('gb-defra-index', 1),
                    'pm2_5': round(air_quality.get('pm2_5', 0), 1),
                    'pm10': round(air_quality.get('pm10', 0), 1),
                    'co': round(air_quality.get('co', 0), 1),
                    'no2': round(air_quality.get('no2', 0), 1),
                    'o3': round(air_quality.get('o3', 0), 1),
                    'so2': round(air_quality.get('so2', 0), 1)
                }
                
                logger.info(f"Returning {len(days)} days of real forecast")
                return jsonify({
                    "forecast": days,
                    "air_quality": aqi_data
                })
        
        logger.warning(f"WeatherAPI returned {response.status_code}")
    
    except Exception as e:
        logger.error(f"7-day forecast error: {e}", exc_info=True)
    
    # Fallback mock data
    logger.warning("Using mock 7-day forecast")
    days = []
    day_names = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']
    today = datetime.now()
    
    for i in range(7):
        day_date = today + timedelta(days=i)
        days.append({
            'day': day_names[day_date.weekday()],
            'date': day_date.strftime('%Y-%m-%d'),
            'max_temp_c': round(20 + random.uniform(-5, 10), 1),
            'min_temp_c': round(15 + random.uniform(-3, 5), 1),
            'condition': random.choice(['Clear', 'Partly Cloudy', 'Cloudy', 'Light Rain']),
            'rain_chance': random.randint(0, 60),
            'snow_chance': 0,
            'avg_humidity': random.randint(40, 80),
            'max_wind_kph': round(random.uniform(5, 25), 1)
        })
    
    return jsonify({
        "forecast": days,
        "air_quality": {
            'us_epa_index': 1,
            'pm2_5': 10.0,
            'pm10': 15.0
        }
    })

@app.route('/api/chatbot', methods=['POST'])
@handle_errors
def chatbot():
    data = request.get_json()
    message = data.get('message', '').strip()
    weather_data = data.get('weather_data', {})
    if not message:
        raise ValueError("Message required")
    if not weather_data:
        return jsonify({"response": "Please load weather data first!"}), 200
    response_text = get_chatbot_response(message, weather_data)
    return jsonify({"response": response_text})

@app.route('/api/cache-clear', methods=['POST'])
@handle_errors
def clear_cache_route():
    weather_cache.clear()
    location_cache.clear()
    return jsonify({"message": "Cache cleared"})

@app.route('/health')
def health():
    return jsonify({
        "status": "healthy",
        "timestamp": datetime.now().isoformat(),
        "service": "FlintWeatherAI v1.0",
        "cache_stats": {"weather": weather_cache.size(), "location": location_cache.size()},
        "gemini_enabled": gemini_enabled
    })

@app.errorhandler(404)
def not_found(e):
    return jsonify({"error": "Not found"}), 404

@app.errorhandler(500)
def internal_error(e):
    return jsonify({"error": "Internal error"}), 500

if __name__ == '__main__':
    logger.info("="*70)
    logger.info("FlintWeatherAI v1.0 Starting")
    logger.info("="*70)
    logger.info(f"Gemini: {'Enabled' if gemini_enabled else 'Disabled'}")
    logger.info(f"Weather API: {'Configured' if config.WEATHER_API_KEY else 'Not configured'}")
    logger.info("="*70)
    os.makedirs("static/css", exist_ok=True)
    os.makedirs("static/js", exist_ok=True)
    os.makedirs("static/images", exist_ok=True)
    port = int(os.environ.get('PORT', 8000))
    app.run(host='0.0.0.0', port=port, debug=False)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FILE: config/__init__.py
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€



â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FILE: config/config.py
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

import os
from dataclasses import dataclass

@dataclass
class Config:
    GEMINI_API_KEY: str = os.getenv("GEMINI_API_KEY", "AIzaSyDQ5xYoZurnsQ7w-sW28pTgPU8IeBH2q3g")
    GEMINI_API_URL: str = "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent"
    WEATHER_API_KEY: str = "b010b4bbd1524f6c92c192501251111"
    HOST: str = "0.0.0.0"
    PORT: int = 8000
    DEBUG: bool = False
    SECRET_KEY: str = "flint-weather-ai-2025"
    MAX_CONTENT_LENGTH: int = 16777216
    CACHE_DURATION: int = 600
    MAX_CACHE_SIZE: int = 500
    NOMINATIM_USER_AGENT: str = "FlintWeatherAI/1.0"
    NOMINATIM_TIMEOUT: int = 10
    MAX_RETRIES: int = 2
    BASE_DELAY: float = 2.0
    MAX_DELAY: float = 10.0
    REQUEST_TIMEOUT: int = 15
    GEMINI_RATE_LIMIT_DELAY: float = 10.0
    GEMINI_MAX_REQUESTS_PER_MINUTE: int = 5
    GEMINI_MAX_REQUESTS_PER_DAY: int = 150
    USE_GEMINI: bool = True
    GEMINI_CACHE_TTL: int = 7200
    GEMINI_MAX_OUTPUT_TOKENS: int = 350

def get_config():
    return Config()


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FILE: utils/__init__.py
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€



â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FILE: utils/cache.py
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

import threading
from collections import OrderedDict
from datetime import datetime
from typing import Any, Dict, Optional
import logging

logger = logging.getLogger(__name__)

class ThreadSafeLRUCache:
    """Thread-safe LRU cache with TTL support"""
    
    def __init__(self, max_size: int = 1000):
        self.cache = OrderedDict()
        self.max_size = max_size
        self.lock = threading.Lock()
        self.stats = {'hits': 0, 'misses': 0, 'evictions': 0, 'sets': 0}
    
    def get(self, key: str) -> Optional[Any]:
        """Get value from cache"""
        with self.lock:
            if key not in self.cache:
                self.stats['misses'] += 1
                return None
            
            entry = self.cache[key]
            if self._is_expired(entry):
                del self.cache[key]
                self.stats['misses'] += 1
                return None
            
            self.cache.move_to_end(key)
            self.stats['hits'] += 1
            return entry['data']
    
    def set(self, key: str, data: Any, ttl: int = 300):
        """Set value in cache with TTL"""
        with self.lock:
            if key in self.cache:
                del self.cache[key]
            elif len(self.cache) >= self.max_size:
                self.cache.popitem(last=False)
                self.stats['evictions'] += 1
            
            self.cache[key] = {
                'data': data,
                'timestamp': datetime.now(),
                'ttl': ttl
            }
            self.stats['sets'] += 1
    
    def _is_expired(self, entry: Dict) -> bool:
        """Check if cache entry is expired"""
        age = (datetime.now() - entry['timestamp']).total_seconds()
        return age >= entry['ttl']
    
    def clear(self):
        """Clear all cache"""
        with self.lock:
            self.cache.clear()
    
    def size(self) -> int:
        """Get cache size"""
        with self.lock:
            return len(self.cache)
    
    def get_stats(self) -> Dict:
        """Get cache statistics"""
        with self.lock:
            return self.stats.copy()


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FILE: utils/weather.py
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

from typing import Dict

class WeatherUtils:
    """Weather utility functions"""
    
    @staticmethod
    def get_weather_icon(condition: str) -> str:
        """Get Font Awesome icon class for weather condition"""
        if not condition:
            return "fa-cloud"
        
        condition = condition.lower()
        if 'clear' in condition or 'sunny' in condition:
            return "fa-sun"
        elif 'rain' in condition:
            return "fa-cloud-rain"
        elif 'snow' in condition:
            return "fa-snowflake"
        elif 'cloud' in condition:
            return "fa-cloud"
        elif 'storm' in condition or 'thunder' in condition:
            return "fa-bolt"
        elif 'fog' in condition or 'mist' in condition:
            return "fa-smog"
        elif 'wind' in condition:
            return "fa-wind"
        return "fa-cloud"
    
    @staticmethod
    def get_uv_index_level(uv: float) -> Dict[str, str]:
        """Get UV index level information"""
        if uv <= 2:
            return {
                "level": "Low",
                "color": "#4ade80",
                "recommendation": "No protection needed"
            }
        elif uv <= 5:
            return {
                "level": "Moderate",
                "color": "#facc15",
                "recommendation": "Wear sunscreen"
            }
        elif uv <= 7:
            return {
                "level": "High",
                "color": "#fb923c",
                "recommendation": "Protection essential"
            }
        elif uv <= 10:
            return {
                "level": "Very High",
                "color": "#ef4444",
                "recommendation": "Extra protection required"
            }
        else:
            return {
                "level": "Extreme",
                "color": "#a855f7",
                "recommendation": "Avoid sun exposure"
            }
    
    @staticmethod
    def celsius_to_fahrenheit(celsius: float) -> float:
        """Convert Celsius to Fahrenheit"""
        return round((celsius * 9/5) + 32, 1)
    
    @staticmethod
    def get_wind_direction_arrow(direction: str) -> str:
        """Get arrow emoji for wind direction"""
        directions = {
            'N': 'â†‘', 'NNE': 'â†—', 'NE': 'â†—', 'ENE': 'â†—',
            'E': 'â†’', 'ESE': 'â†˜', 'SE': 'â†˜', 'SSE': 'â†˜',
            'S': 'â†“', 'SSW': 'â†™', 'SW': 'â†™', 'WSW': 'â†™',
            'W': 'â†', 'WNW': 'â†–', 'NW': 'â†–', 'NNW': 'â†–'
        }
        return directions.get(direction, 'â€¢')


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FILE: utils/free_weather_apis.py
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

import requests
import random
from typing import Dict, Optional
import logging

logger = logging.getLogger(__name__)

class FreeWeatherAPIs:
    """Free Weather API integrations"""
    
    @staticmethod
    def get_weatherapi(lat: float, lon: float, api_key: str) -> Optional[Dict]:
        """Get weather from WeatherAPI.com"""
        try:
            url = f"http://api.weatherapi.com/v1/current.json"
            params = {
                "key": api_key,
                "q": f"{lat},{lon}",
                "aqi": "no"
            }
            response = requests.get(url, params=params, timeout=10)
            response.raise_for_status()
            data = response.json()
            
            current = data.get("current", {})
            location = data.get("location", {})
            
            return {
                "temperature_celsius": current.get("temp_c", 0),
                "temperature_fahrenheit": current.get("temp_f", 0),
                "feels_like_celsius": current.get("feelslike_c", 0),
                "condition": current.get("condition", {}).get("text", "Unknown"),
                "description": f"Currently {current.get('condition', {}).get('text', 'unknown').lower()}",
                "humidity_percent": current.get("humidity", 0),
                "wind_speed_kmh": current.get("wind_kph", 0),
                "wind_direction": current.get("wind_dir", "NA"),
                "pressure_mb": current.get("pressure_mb", 1013),
                "visibility_km": current.get("vis_km", 10),
                "uv_index": current.get("uv", 0),
                "cloud_cover_percent": current.get("cloud", 0),
                "precipitation_mm": current.get("precip_mm", 0),
                "is_real_data": True,
                "source": "WeatherAPI.com"
            }
        except Exception as e:
            logger.debug(f"WeatherAPI failed: {e}")
            return None
    
    @staticmethod
    def get_open_meteo(lat: float, lon: float) -> Optional[Dict]:
        """Get weather from Open-Meteo API"""
        try:
            url = "https://api.open-meteo.com/v1/forecast"
            params = {
                "latitude": lat,
                "longitude": lon,
                "current": "temperature_2m,relative_humidity_2m,apparent_temperature,precipitation,weather_code,pressure_msl,cloud_cover,wind_speed_10m",
                "timezone": "auto"
            }
            response = requests.get(url, params=params, timeout=10)
            response.raise_for_status()
            data = response.json()
            
            current = data.get("current", {})
            weather_codes = {
                0: "Clear sky", 1: "Mainly clear", 2: "Partly cloudy",
                3: "Overcast", 45: "Foggy", 61: "Slight rain",
                63: "Moderate rain", 65: "Heavy rain", 71: "Slight snow",
                73: "Moderate snow", 95: "Thunderstorm"
            }
            
            condition = weather_codes.get(current.get("weather_code", 0), "Unknown")
            temp_c = current.get("temperature_2m", 0)
            
            return {
                "temperature_celsius": temp_c,
                "temperature_fahrenheit": round((temp_c * 9/5) + 32, 1),
                "feels_like_celsius": current.get("apparent_temperature", temp_c),
                "condition": condition,
                "description": f"Currently {condition.lower()}",
                "humidity_percent": current.get("relative_humidity_2m", 50),
                "wind_speed_kmh": current.get("wind_speed_10m", 0),
                "wind_direction": "NA",
                "pressure_mb": current.get("pressure_msl", 1013),
                "visibility_km": 10,
                "uv_index": 0,
                "cloud_cover_percent": current.get("cloud_cover", 0),
                "precipitation_mm": current.get("precipitation", 0),
                "is_real_data": True,
                "source": "Open-Meteo"
            }
        except Exception as e:
            logger.debug(f"Open-Meteo failed: {e}")
            return None
    
    @staticmethod
    def get_mock_weather(lat: float, lon: float) -> Dict:
        """Generate mock weather data"""
        base_temp = 25 - (abs(lat) * 0.5)
        temp_c = round(base_temp + random.uniform(-5, 8), 1)
        conditions = ["Clear sky", "Partly cloudy", "Cloudy", "Light rain"]
        condition = random.choice(conditions)
        
        return {
            "temperature_celsius": temp_c,
            "temperature_fahrenheit": round((temp_c * 9/5) + 32, 1),
            "feels_like_celsius": round(temp_c + random.uniform(-2, 2), 1),
            "condition": condition,
            "description": f"Currently {condition.lower()}",
            "humidity_percent": random.randint(40, 85),
            "wind_speed_kmh": round(random.uniform(5, 25), 1),
            "wind_direction": random.choice(["N", "NE", "E", "SE", "S", "SW", "W", "NW"]),
            "pressure_mb": random.randint(1005, 1025),
            "visibility_km": random.randint(8, 20),
            "uv_index": random.randint(1, 9),
            "cloud_cover_percent": random.randint(10, 90),
            "precipitation_mm": 0,
            "is_mock_data": True,
            "is_real_data": False,
            "source": "Mock Data"
        }
    
    @staticmethod
    def get_weather(lat: float, lon: float, api_key: str = None) -> Dict:
        """Get weather from available sources with fallback"""
        logger.info(f"Fetching weather for {lat:.4f}, {lon:.4f}")
        
        if api_key:
            weather_data = FreeWeatherAPIs.get_weatherapi(lat, lon, api_key)
            if weather_data:
                logger.info("Using WeatherAPI.com")
                return weather_data
        
        weather_data = FreeWeatherAPIs.get_open_meteo(lat, lon)
        if weather_data:
            logger.info("Using Open-Meteo")
            return weather_data
        
        logger.warning("Using mock data")
        return FreeWeatherAPIs.get_mock_weather(lat, lon)


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FILE: utils/free_ai_apis.py
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

import random
from typing import Dict
import logging

logger = logging.getLogger(__name__)

class FreeAIAPIs:
    """Fallback AI chatbot responses"""
    
    @staticmethod
    def get_chat_response(message: str, weather_data: Dict) -> str:
        """Generate chatbot response based on message and weather"""
        message_lower = message.lower()
        current = weather_data.get("current_weather", {})
        location = weather_data.get("location", {})
        
        temp = current.get("temperature_celsius", 0)
        temp_f = current.get("temperature_fahrenheit", 0)
        condition = current.get("condition", "").lower()
        city = location.get("city", "your location")
        
        # Greetings
        if any(w in message_lower for w in ["hello", "hi", "hey"]):
            return f"ğŸ‘‹ Hello! Weather in {city}: {condition}, {temp}Â°C. How can I help?"
        
        # Temperature queries
        if any(w in message_lower for w in ["temperature", "temp", "hot", "cold"]):
            feels = current.get("feels_like_celsius", temp)
            if temp > 35:
                advice = "ğŸ”¥ Very hot! Stay hydrated and avoid sun."
            elif temp > 25:
                advice = "â˜€ï¸ Warm! Good weather."
            elif temp > 15:
                advice = "ğŸ˜Š Pleasant temperature."
            elif temp > 5:
                advice = "ğŸ§¥ Cool, wear a jacket."
            else:
                advice = "â„ï¸ Cold! Bundle up."
            return f"Temperature: {temp}Â°C ({temp_f}Â°F), feels like {feels}Â°C. {advice}"
        
        # Rain queries
        if any(w in message_lower for w in ["rain", "umbrella", "wet"]):
            precip = current.get("precipitation_mm", 0)
            if "rain" in condition or precip > 0:
                return f"ğŸŒ§ï¸ Yes, {condition} with {precip}mm precipitation. Bring umbrella!"
            return f"â˜€ï¸ No rain. It's {condition}."
        
        # Humidity queries
        if any(w in message_lower for w in ["humidity", "humid"]):
            humidity = current.get("humidity_percent", 0)
            if humidity > 80:
                return f"ğŸ’§ Very humid: {humidity}%. May feel warmer."
            elif humidity > 60:
                return f"ğŸ’¦ Moderate humidity: {humidity}%."
            return f"ğŸ˜Š Low humidity: {humidity}%. Comfortable."
        
        # Wind queries
        if any(w in message_lower for w in ["wind", "windy"]):
            wind = current.get("wind_speed_kmh", 0)
            if wind > 30:
                return f"ğŸ’¨ Very windy at {wind} km/h! Be careful."
            elif wind > 15:
                return f"ğŸƒ Breezy at {wind} km/h."
            return f"ğŸŒ¬ï¸ Light wind at {wind} km/h."
        
        # General weather summary
        if any(w in message_lower for w in ["weather", "conditions", "today"]):
            wind = current.get("wind_speed_kmh", 0)
            humidity = current.get("humidity_percent", 0)
            return f"â›… {city}: {condition}, {temp}Â°C. Wind: {wind} km/h, Humidity: {humidity}%."
        
        # Default responses
        responses = [
            f"Weather in {city}: {condition}, {temp}Â°C. What would you like to know?",
            f"I can help with weather info! Ask about temp, rain, wind, etc.",
            f"Current conditions: {condition}. Need specific details?"
        ]
        return random.choice(responses)


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FILE: test_imports.py
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

#!/usr/bin/env python3
import sys
import os

PROJECT_ROOT = os.path.dirname(os.path.abspath(__file__))
sys.path.insert(0, PROJECT_ROOT)

print("=" * 50)
print("Testing FlintWeatherAI Imports")
print("=" * 50)
print()

tests = [
    ("Flask", "flask"),
    ("Flask-CORS", "flask_cors"),
    ("Requests", "requests"),
    ("Python-DateUtil", "dateutil"),
    ("Google GenAI", "google.generativeai"),
    ("Config Module", "config.config"),
    ("Cache Module", "utils.cache"),
    ("Weather Module", "utils.weather"),
    ("Weather APIs Module", "utils.free_weather_apis"),
    ("AI APIs Module", "utils.free_ai_apis"),
]

failed = 0
for name, module in tests:
    try:
        __import__(module)
        print(f"âœ… {name:20s} OK")
    except ImportError as e:
        print(f"âŒ {name:20s} FAILED: {e}")
        failed += 1

print()
print("=" * 50)
if failed == 0:
    print("âœ… All imports successful! Ready to start.")
    sys.exit(0)
else:
    print(f"âŒ {failed} import(s) failed!")
    sys.exit(1)


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FILE: test_gemini_api.py
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

import requests
import time

api_key = "AIzaSyDQ5xYoZurnsQ7w-sW28pTgPU8IeBH2q3g"
url = f"https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key={api_key}"

print("Testing Gemini API...")
print("Waiting 15 seconds...")
time.sleep(15)

payload = {"contents": [{"parts": [{"text": "Say hello"}]}], "generationConfig": {"maxOutputTokens": 10}}

try:
    response = requests.post(url, json=payload, timeout=10)
    print(f"Status: {response.status_code}")
    if response.status_code == 200:
        data = response.json()
        print("SUCCESS!")
        print(f"Response: {data["candidates"][0]["content"]["parts"][0]["text"]}")
    elif response.status_code == 429:
        print("RATE LIMITED - Wait 60 seconds")
    else:
        print(f"Error: {response.text[:200]}")
except Exception as e:
    print(f"Exception: {e}")


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FILE: setup_logging.py
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

import logging
import sys
from logging.handlers import RotatingFileHandler

# Create detailed formatter
detailed_formatter = logging.Formatter(
    '%(asctime)s | %(name)s | %(levelname)s | %(funcName)s:%(lineno)d | %(message)s',
    datefmt='%Y-%m-%d %H:%M:%S'
)

# Main log file - everything
main_handler = RotatingFileHandler('logs/overall.log', maxBytes=20*1024*1024, backupCount=5)
main_handler.setFormatter(detailed_formatter)
main_handler.setLevel(logging.DEBUG)

# Error log file
error_handler = RotatingFileHandler('logs/errors.log', maxBytes=10*1024*1024, backupCount=3)
error_handler.setFormatter(detailed_formatter)
error_handler.setLevel(logging.ERROR)

# Console handler
console_handler = logging.StreamHandler(sys.stdout)
console_handler.setFormatter(logging.Formatter('%(levelname)s | %(message)s'))
console_handler.setLevel(logging.INFO)

# Root logger
root_logger = logging.getLogger()
root_logger.setLevel(logging.DEBUG)
root_logger.addHandler(main_handler)
root_logger.addHandler(error_handler)
root_logger.addHandler(console_handler)

# Requests library logger
requests_logger = logging.getLogger('requests')
requests_logger.setLevel(logging.WARNING)

print("Logging configured: logs/overall.log, logs/errors.log")


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FILE: static/js/app.js
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// FlintWeatherAI - Frontend JavaScript
// Author: AkNG
// Version: 1.0

let currentWeatherData = null;
let currentTab = 'overview';
let temperatureUnit = 'C';
let isDarkTheme = false;

// Initialize app
document.addEventListener('DOMContentLoaded', () => {
    console.log('ğŸŒ¤ï¸ FlintWeatherAI v1.0 Initialized');
    loadThemePreference();
    loadUnitPreference();
    loadWeather();
});

// Theme Management
function loadThemePreference() {
    const savedTheme = localStorage.getItem('theme') || 'light';
    isDarkTheme = savedTheme === 'dark';
    updateTheme();
}

function toggleTheme() {
    isDarkTheme = !isDarkTheme;
    updateTheme();
    localStorage.setItem('theme', isDarkTheme ? 'dark' : 'light');
}

function updateTheme() {
    document.documentElement.setAttribute('data-theme', isDarkTheme ? 'dark' : 'light');
    const track = document.querySelector('.theme-toggle-track');
    if (track) {
        track.classList.toggle('active', isDarkTheme);
    }
}

// Unit Management
function loadUnitPreference() {
    temperatureUnit = localStorage.getItem('unit') || 'C';
    const unitSelect = document.getElementById('unitSelect');
    if (unitSelect) unitSelect.value = temperatureUnit;
}

function changeUnit(unit) {
    temperatureUnit = unit;
    localStorage.setItem('unit', unit);
    if (currentWeatherData) {
        renderWeatherData(currentWeatherData);
    }
}

// Settings Panel
function toggleSettings() {
    const panel = document.getElementById('settingsPanel');
    panel.classList.toggle('active');
}

// Tab Navigation
function switchTab(tabName) {
    currentTab = tabName;
    
    // Update tab buttons
    document.querySelectorAll('.nav-tab').forEach(tab => {
        tab.classList.remove('active');
    });
    document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
    
    // Re-render content
    if (currentWeatherData) {
        renderWeatherData(currentWeatherData);
    }
}

// Weather Loading
async function loadWeather() {
    showLoader('Getting your location...');
    
    if (!navigator.geolocation) {
        showError('Geolocation not supported');
        return;
    }
    
    navigator.geolocation.getCurrentPosition(
        async (position) => {
            const { latitude, longitude } = position.coords;
            await fetchWeatherData(latitude, longitude);
        },
        (error) => {
            console.error('Geolocation error:', error);
            showError('Location access denied. Please search manually.');
        }
    );
}

async function fetchWeatherData(lat, lon) {
    try {
        showLoader('Fetching weather data...');
        
        const response = await fetch('/api/weather', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ latitude: lat, longitude: lon })
        });
        
        if (!response.ok) {
            throw new Error('Weather fetch failed');
        }
        
        const data = await response.json();
        currentWeatherData = data;
        renderWeatherData(data);
        
    } catch (error) {
        console.error('Weather fetch error:', error);
        showError('Failed to load weather data. Please try again.');
    }
}

// Search Functionality
async function performSearch() {
    const input = document.getElementById('searchInput');
    const query = input.value.trim();
    
    if (!query) return;
    
    try {
        showLoader('Searching locations...');
        
        const response = await fetch('/api/search-location', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ query })
        });
        
        const data = await response.json();
        
        if (data.results && data.results.length > 0) {
            const first = data.results[0];
            await fetchWeatherData(first.latitude, first.longitude);
            input.value = '';
        } else {
            showError('No locations found. Try another search.');
        }
        
    } catch (error) {
        console.error('Search error:', error);
        showError('Search failed. Please try again.');
    }
}

// Refresh Weather
async function refreshWeather() {
    if (!currentWeatherData) {
        loadWeather();
        return;
    }
    
    const location = currentWeatherData.location;
    if (location) {
        await fetchWeatherData(location.latitude, location.longitude);
    }
}

// Render Weather Data
function renderWeatherData(data) {
    const mainContent = document.getElementById('mainContent');
    
    switch (currentTab) {
        case 'overview':
            mainContent.innerHTML = renderOverviewTab(data);
            break;
        case 'hourly':
            mainContent.innerHTML = renderHourlyTab(data);
            loadHourlyForecast(data.location.latitude, data.location.longitude);
            break;
        case 'forecast':
            mainContent.innerHTML = renderForecastTab(data);
            break;
        case 'details':
            mainContent.innerHTML = renderDetailsTab(data);
            break;
    }
}

// Overview Tab
function renderOverviewTab(data) {
    const { current_weather, location, weather_tips, forecast } = data;
    const temp = getTemperature(current_weather.temperature_celsius);
    const feelsLike = getTemperature(current_weather.feels_like_celsius);
    
    return `
        <!-- Location Card -->
        <div class="weather-card">
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 24px;">
                <div>
                    <h2 style="font-size: 2rem; font-weight: 800; color: var(--text-1); margin-bottom: 4px;">
                        ${location.city}
                    </h2>
                    <p style="color: var(--text-3); font-size: 1rem;">
                        ${location.locality} â€¢ ${location.country}
                    </p>
                </div>
                <div style="text-align: right;">
                    <div style="font-size: 3.5rem; font-weight: 900; color: var(--primary); line-height: 1;">
                        ${temp}
                    </div>
                    <p style="color: var(--text-3); margin-top: 4px;">
                        Feels like ${feelsLike}
                    </p>
                </div>
            </div>
            
            <div style="display: flex; align-items: center; gap: 16px; padding: 20px; background: var(--bg-2); border-radius: var(--radius); margin-bottom: 20px;">
                <i class="fas ${getWeatherIcon(current_weather.condition)} fa-3x" style="color: var(--primary);"></i>
                <div>
                    <h3 style="font-size: 1.5rem; font-weight: 700; color: var(--text-1);">
                        ${current_weather.condition}
                    </h3>
                    <p style="color: var(--text-2);">
                        ${current_weather.description}
                    </p>
                </div>
            </div>
            
            <!-- Weather Metrics Grid -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px;">
                ${renderMetricCard('ğŸ’§', 'Humidity', `${current_weather.humidity_percent}%`)}
                ${renderMetricCard('ğŸ’¨', 'Wind', `${current_weather.wind_speed_kmh} km/h`)}
                ${renderMetricCard('ğŸŒ¡ï¸', 'Pressure', `${current_weather.pressure_mb} mb`)}
                ${renderMetricCard('ğŸ‘ï¸', 'Visibility', `${current_weather.visibility_km} km`)}
                ${renderMetricCard('â˜€ï¸', 'UV Index', current_weather.uv_index)}
                ${renderMetricCard('â˜ï¸', 'Cloud Cover', `${current_weather.cloud_cover_percent}%`)}
            </div>
        </div>
        
        <!-- Weather Tips -->
        <div class="weather-card">
            <h3 style="font-size: 1.3rem; font-weight: 700; color: var(--text-1); margin-bottom: 16px;">
                <i class="fas fa-lightbulb"></i> Weather Tips
            </h3>
            <div style="display: flex; flex-direction: column; gap: 12px;">
                ${weather_tips.map(tip => `
                    <div style="padding: 12px 16px; background: var(--bg-2); border-radius: var(--radius); border-left: 4px solid var(--primary);">
                        ${tip}
                    </div>
                `).join('')}
            </div>
        </div>
        
        <!-- 3-Day Forecast Preview -->
        <div class="weather-card">
            <h3 style="font-size: 1.3rem; font-weight: 700; color: var(--text-1); margin-bottom: 16px;">
                <i class="fas fa-calendar-days"></i> 3-Day Outlook
            </h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                ${renderForecastCard('Today', forecast.today, 'fa-sun')}
                ${renderForecastCard('Tomorrow', forecast.tomorrow, 'fa-cloud-sun')}
                ${renderForecastCard('Day After', forecast.day_after, 'fa-cloud')}
            </div>
        </div>
    `;
}

// Hourly Tab
function renderHourlyTab(data) {
    return `
        <div class="weather-card">
            <h3 style="font-size: 1.3rem; font-weight: 700; color: var(--text-1); margin-bottom: 20px;">
                <i class="fas fa-clock"></i> 24-Hour Forecast
            </h3>
            <div id="hourlyContent">
                <div class="loader-container">
                    <div class="spinner"></div>
                    <p class="loader-text">Loading hourly forecast...</p>
                </div>
            </div>
        </div>
    `;
}

async function loadHourlyForecast(lat, lon) {
    try {
        const response = await fetch('/api/hourly', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ latitude: lat, longitude: lon })
        });
        
        const data = await response.json();
        const hourlyContent = document.getElementById('hourlyContent');
        
        hourlyContent.innerHTML = `
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 16px;">
                ${data.hourly_forecast.slice(0, 12).map(hour => `
                    <div style="padding: 16px; background: var(--bg-2); border-radius: var(--radius); text-align: center;">
                        <div style="font-weight: 600; color: var(--text-1); margin-bottom: 8px;">
                            ${hour.hour}
                        </div>
                        <i class="fas ${getWeatherIcon(hour.condition)} fa-2x" style="color: var(--primary); margin: 8px 0;"></i>
                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--primary); margin: 8px 0;">
                            ${getTemperature(hour.temperature_celsius)}
                        </div>
                        <div style="color: var(--text-3); font-size: 0.875rem;">
                            ğŸ’§ ${hour.precipitation_chance}%
                        </div>
                    </div>
                `).join('')}
            </div>
        `;
        
    } catch (error) {
        console.error('Hourly forecast error:', error);
        document.getElementById('hourlyContent').innerHTML = `
            <p style="text-align: center; color: var(--text-3);">
                Failed to load hourly forecast
            </p>
        `;
    }
}

// Forecast Tab
function renderForecastTab(data) {
    const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
    const icons = ['fa-sun', 'fa-cloud-sun', 'fa-cloud', 'fa-cloud-rain', 'fa-cloud-sun', 'fa-sun', 'fa-cloud'];
    
    return `
        <div class="weather-card">
            <h3 style="font-size: 1.3rem; font-weight: 700; color: var(--text-1); margin-bottom: 20px;">
                <i class="fas fa-calendar-week"></i> 7-Day Forecast
            </h3>
            <div style="display: flex; flex-direction: column; gap: 12px;">
                ${days.map((day, i) => {
                    const temp = 20 + Math.random() * 10;
                    return `
                        <div style="display: flex; align-items: center; justify-content: space-between; padding: 16px; background: var(--bg-2); border-radius: var(--radius);">
                            <div style="display: flex; align-items: center; gap: 16px; flex: 1;">
                                <i class="fas ${icons[i]} fa-2x" style="color: var(--primary); width: 40px;"></i>
                                <div>
                                    <div style="font-weight: 600; color: var(--text-1);">${day}</div>
                                    <div style="color: var(--text-3); font-size: 0.875rem;">Partly Cloudy</div>
                                </div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 16px;">
                                <div style="color: var(--text-3);">ğŸ’§ ${Math.floor(Math.random() * 40)}%</div>
                                <div style="font-size: 1.3rem; font-weight: 700; color: var(--primary);">
                                    ${getTemperature(temp)}
                                </div>
                            </div>
                        </div>
                    `;
                }).join('')}
            </div>
        </div>
    `;
}

// Details Tab
function renderDetailsTab(data) {
    const { current_weather, sun_times } = data;
    
    return `
        <div class="weather-card">
            <h3 style="font-size: 1.3rem; font-weight: 700; color: var(--text-1); margin-bottom: 20px;">
                <i class="fas fa-chart-line"></i> Detailed Metrics
            </h3>
            
            <div style="display: grid; gap: 24px;">
                <!-- Temperature Details -->
                <div>
                    <h4 style="font-weight: 600; color: var(--text-1); margin-bottom: 12px;">ğŸŒ¡ï¸ Temperature</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                        ${renderDetailItem('Current', getTemperature(current_weather.temperature_celsius))}
                        ${renderDetailItem('Feels Like', getTemperature(current_weather.feels_like_celsius))}
                        ${renderDetailItem('Fahrenheit', `${current_weather.temperature_fahrenheit}Â°F`)}
                    </div>
                </div>
                
                <!-- Wind Details -->
                <div>
                    <h4 style="font-weight: 600; color: var(--text-1); margin-bottom: 12px;">ğŸ’¨ Wind</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                        ${renderDetailItem('Speed', `${current_weather.wind_speed_kmh} km/h`)}
                        ${renderDetailItem('Direction', current_weather.wind_direction)}
                    </div>
                </div>
                
                <!-- Atmospheric -->
                <div>
                    <h4 style="font-weight: 600; color: var(--text-1); margin-bottom: 12px;">ğŸŒ Atmospheric</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                        ${renderDetailItem('Pressure', `${current_weather.pressure_mb} mb`)}
                        ${renderDetailItem('Humidity', `${current_weather.humidity_percent}%`)}
                        ${renderDetailItem('Visibility', `${current_weather.visibility_km} km`)}
                        ${renderDetailItem('Cloud Cover', `${current_weather.cloud_cover_percent}%`)}
                    </div>
                </div>
                
                <!-- Sun & Moon -->
                <div>
                    <h4 style="font-weight: 600; color: var(--text-1); margin-bottom: 12px;">â˜€ï¸ Sun & Moon</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                        ${renderDetailItem('Sunrise', sun_times.sunrise)}
                        ${renderDetailItem('Sunset', sun_times.sunset)}
                        ${renderDetailItem('Moon Phase', sun_times.moon_phase)}
                        ${renderDetailItem('UV Index', current_weather.uv_index)}
                    </div>
                </div>
            </div>
        </div>
    `;
}

// Helper Render Functions
function renderMetricCard(icon, label, value) {
    return `
        <div style="padding: 16px; background: var(--bg-2); border-radius: var(--radius); text-align: center;">
            <div style="font-size: 2rem; margin-bottom: 8px;">${icon}</div>
            <div style="color: var(--text-3); font-size: 0.875rem; margin-bottom: 4px;">${label}</div>
            <div style="font-size: 1.2rem; font-weight: 700; color: var(--text-1);">${value}</div>
        </div>
    `;
}

function renderForecastCard(day, description, icon) {
    return `
        <div style="padding: 20px; background: var(--bg-2); border-radius: var(--radius); text-align: center;">
            <i class="fas ${icon} fa-3x" style="color: var(--primary); margin-bottom: 12px;"></i>
            <div style="font-weight: 600; color: var(--text-1); margin-bottom: 8px;">${day}</div>
            <div style="color: var(--text-2); font-size: 0.875rem;">${description}</div>
        </div>
    `;
}

function renderDetailItem(label, value) {
    return `
        <div style="padding: 12px; background: var(--bg-2); border-radius: var(--radius);">
            <div style="color: var(--text-3); font-size: 0.875rem; margin-bottom: 4px;">${label}</div>
            <div style="font-weight: 600; color: var(--text-1);">${value}</div>
        </div>
    `;
}

// Utility Functions
function getTemperature(celsius) {
    if (temperatureUnit === 'F') {
        const fahrenheit = Math.round((celsius * 9/5) + 32);
        return `${fahrenheit}Â°F`;
    }
    return `${Math.round(celsius)}Â°C`;
}

function getWeatherIcon(condition) {
    if (!condition) return 'fa-cloud';
    const c = condition.toLowerCase();
    if (c.includes('clear') || c.includes('sunny')) return 'fa-sun';
    if (c.includes('rain')) return 'fa-cloud-rain';
    if (c.includes('snow')) return 'fa-snowflake';
    if (c.includes('cloud')) return 'fa-cloud';
    if (c.includes('storm') || c.includes('thunder')) return 'fa-bolt';
    if (c.includes('fog') || c.includes('mist')) return 'fa-smog';
    if (c.includes('wind')) return 'fa-wind';
    return 'fa-cloud';
}

function showLoader(message = 'Loading...') {
    const mainContent = document.getElementById('mainContent');
    mainContent.innerHTML = `
        <div class="loader-container">
            <div class="spinner"></div>
            <p class="loader-text">${message}</p>
        </div>
    `;
}

function showError(message) {
    const mainContent = document.getElementById('mainContent');
    mainContent.innerHTML = `
        <div class="weather-card" style="text-align: center; padding: 60px 20px;">
            <i class="fas fa-exclamation-triangle fa-4x" style="color: var(--danger); margin-bottom: 20px;"></i>
            <h3 style="color: var(--text-1); margin-bottom: 12px;">Oops!</h3>
            <p style="color: var(--text-2); margin-bottom: 24px;">${message}</p>
            <button onclick="loadWeather()" style="padding: 12px 24px; background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; border: none; border-radius: var(--radius); cursor: pointer; font-weight: 600;">
                Try Again
            </button>
        </div>
    `;
}

// Chat Functions
function toggleChat() {
    const panel = document.getElementById('chatPanel');
    panel.classList.toggle('active');
}

async function sendChat() {
    const input = document.getElementById('chatInput');
    const message = input.value.trim();
    
    if (!message || !currentWeatherData) return;
    
    // Add user message
    addChatMessage(message, 'user');
    input.value = '';
    
    // Show typing indicator
    const typingId = addChatMessage('Thinking...', 'bot', true);
    
    try {
        const response = await fetch('/api/chatbot', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                message: message,
                weather_data: currentWeatherData
            })
        });
        
        const data = await response.json();
        
        // Remove typing indicator
        document.getElementById(typingId)?.remove();
        
        // Add bot response
        addChatMessage(data.response, 'bot');
        
    } catch (error) {
        document.getElementById(typingId)?.remove();
        addChatMessage('Sorry, I encountered an error. Please try again.', 'bot');
    }
}

function addChatMessage(text, sender, isTyping = false) {
    const messagesDiv = document.getElementById('chatMessages');
    const messageId = `msg-${Date.now()}`;
    
    const avatar = sender === 'bot' ? 
        '<div class="chat-avatar bot-avatar"><i class="fas fa-robot"></i></div>' :
        '<div class="chat-avatar user-avatar"><i class="fas fa-user"></i></div>';
    
    const messageHtml = `
        <div class="chat-msg ${sender}" id="${messageId}">
            ${avatar}
            <div class="chat-bubble">${text}</div>
        </div>
    `;
    
    messagesDiv.insertAdjacentHTML('beforeend', messageHtml);
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
    
    return messageId;
}

// Clear Cache
async function clearCache() {
    try {
        await fetch('/api/cache-clear', { method: 'POST' });
        alert('Cache cleared successfully!');
    } catch (error) {
        alert('Failed to clear cache');
    }
}

// Auto-resize chat input
document.addEventListener('DOMContentLoaded', () => {
    const chatInput = document.getElementById('chatInput');
    if (chatInput) {
        chatInput.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 100) + 'px';
        });
    }
});

console.log('âœ… FlintWeatherAI Frontend Loaded');

// Load 7-day forecast
async function load7DayForecast(lat, lon) {
    try {
        const response = await fetch('/api/forecast', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ latitude: lat, longitude: lon })
        });
        
        const data = await response.json();
        const forecastContent = document.getElementById('forecastContent');
        
        if (data.forecast && data.forecast.length > 0) {
            forecastContent.innerHTML = `
                <div style="display: flex; flex-direction: column; gap: 12px;">
                    ${data.forecast.map(day => `
                        <div style="display: flex; align-items: center; justify-content: space-between; padding: 16px; background: var(--bg-2); border-radius: var(--radius);">
                            <div style="display: flex; align-items: center; gap: 16px; flex: 1;">
                                <i class="fas ${getWeatherIcon(day.condition)} fa-2x" style="color: var(--primary); width: 40px;"></i>
                                <div>
                                    <div style="font-weight: 600; color: var(--text-1);">${day.day}</div>
                                    <div style="color: var(--text-3); font-size: 0.875rem;">${day.condition}</div>
                                </div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 16px;">
                                <div style="color: var(--text-3);">ğŸ’§ ${day.rain_chance}%</div>
                                <div style="font-size: 1.1rem; color: var(--text-2);">${getTemperature(day.min_temp_c)}</div>
                                <div style="font-size: 1.3rem; font-weight: 700; color: var(--primary);">${getTemperature(day.max_temp_c)}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <div style="margin-top: 24px; padding: 20px; background: var(--bg-2); border-radius: var(--radius);">
                    <h4 style="font-weight: 600; color: var(--text-1); margin-bottom: 12px;">
                        <i class="fas fa-wind"></i> Air Quality Index
                    </h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px;">
                        <div style="padding: 12px; background: var(--bg-3); border-radius: var(--radius); text-align: center;">
                            <div style="font-size: 2rem; font-weight: 700; color: var(--primary);">${data.air_quality.us_epa_index || 1}</div>
                            <div style="color: var(--text-3); font-size: 0.875rem;">US EPA Index</div>
                        </div>
                        <div style="padding: 12px; background: var(--bg-3); border-radius: var(--radius); text-align: center;">
                            <div style="font-size: 2rem; font-weight: 700; color: var(--primary);">${data.air_quality.pm2_5 || 0}</div>
                            <div style="color: var(--text-3); font-size: 0.875rem;">PM2.5</div>
                        </div>
                        <div style="padding: 12px; background: var(--bg-3); border-radius: var(--radius); text-align: center;">
                            <div style="font-size: 2rem; font-weight: 700; color: var(--primary);">${data.air_quality.pm10 || 0}</div>
                            <div style="color: var(--text-3); font-size: 0.875rem;">PM10</div>
                        </div>
                    </div>
                </div>
            `;
        }
    } catch (error) {
        console.error('7-day forecast error:', error);
        document.getElementById('forecastContent').innerHTML = '<p style="text-align: center; color: var(--text-3);">Failed to load forecast</p>';
    }
}

// Update switchTab to load forecast
const originalSwitchTab = switchTab;
switchTab = function(tabName) {
    originalSwitchTab(tabName);
    if (tabName === 'forecast' && currentWeatherData) {
        load7DayForecast(currentWeatherData.location.latitude, currentWeatherData.location.longitude);
    }
};


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FILE: service-worker.js
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const CACHE_NAME = 'flintweather-v1.0';
const urlsToCache = [
  '/',
  '/static/css/style.css',
  '/static/js/app.js',
  '/manifest.json'
];

self.addEventListener('install', event => {
  event.waitUntil(
    caches.open(CACHE_NAME)
      .then(cache => cache.addAll(urlsToCache))
  );
});

self.addEventListener('fetch', event => {
  event.respondWith(
    caches.match(event.request)
      .then(response => response || fetch(event.request))
  );
});

self.addEventListener('activate', event => {
  event.waitUntil(
    caches.keys().then(cacheNames => {
      return Promise.all(
        cacheNames.map(cacheName => {
          if (cacheName !== CACHE_NAME) {
            return caches.delete(cacheName);
          }
        })
      );
    })
  );
});


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FILE: docs/js/app.js
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// FlintWeatherAI - GitHub Pages Frontend
// Backend API: Render

const API_BASE_URL = 'https://flintweatherai.onrender.com';

let currentWeatherData = null;
let currentTab = 'overview';
let temperatureUnit = 'C';
let isDarkTheme = false;

document.addEventListener('DOMContentLoaded', () => {
    console.log('ğŸŒ¤ï¸ FlintWeatherAI v1.0 Initialized (GitHub Pages)');
    loadThemePreference();
    loadUnitPreference();
    loadWeather();
});

function loadThemePreference() {
    const savedTheme = localStorage.getItem('theme') || 'light';
    isDarkTheme = savedTheme === 'dark';
    updateTheme();
}

function toggleTheme() {
    isDarkTheme = !isDarkTheme;
    updateTheme();
    localStorage.setItem('theme', isDarkTheme ? 'dark' : 'light');
}

function updateTheme() {
    document.documentElement.setAttribute('data-theme', isDarkTheme ? 'dark' : 'light');
    const track = document.querySelector('.theme-toggle-track');
    if (track) {
        track.classList.toggle('active', isDarkTheme);
    }
}

function loadUnitPreference() {
    temperatureUnit = localStorage.getItem('unit') || 'C';
    const unitSelect = document.getElementById('unitSelect');
    if (unitSelect) unitSelect.value = temperatureUnit;
}

function changeUnit(unit) {
    temperatureUnit = unit;
    localStorage.setItem('unit', unit);
    if (currentWeatherData) {
        renderWeatherData(currentWeatherData);
    }
}

function toggleSettings() {
    const panel = document.getElementById('settingsPanel');
    panel.classList.toggle('active');
}

function switchTab(tabName) {
    currentTab = tabName;
    
    document.querySelectorAll('.nav-tab').forEach(tab => {
        tab.classList.remove('active');
    });
    document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
    
    if (currentWeatherData) {
        renderWeatherData(currentWeatherData);
    }
}

async function loadWeather() {
    showLoader('Getting your location...');
    
    if (!navigator.geolocation) {
        showError('Geolocation not supported');
        return;
    }
    
    navigator.geolocation.getCurrentPosition(
        async (position) => {
            const { latitude, longitude } = position.coords;
            await fetchWeatherData(latitude, longitude);
        },
        (error) => {
            console.error('Geolocation error:', error);
            showError('Location access denied. Please search manually.');
        }
    );
}

async function fetchWeatherData(lat, lon) {
    try {
        showLoader('Fetching weather data...');
        
        const response = await fetch(`${API_BASE_URL}/api/weather`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ latitude: lat, longitude: lon })
        });
        
        if (!response.ok) {
            throw new Error('Weather fetch failed');
        }
        
        const data = await response.json();
        currentWeatherData = data;
        renderWeatherData(data);
        
    } catch (error) {
        console.error('Weather fetch error:', error);
        showError('Failed to load weather data. Backend may be sleeping (Render free tier). Please try again in 30 seconds.');
    }
}

async function performSearch() {
    const input = document.getElementById('searchInput');
    const query = input.value.trim();
    
    if (!query) return;
    
    try {
        showLoader('Searching locations...');
        
        const response = await fetch(`${API_BASE_URL}/api/search-location`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ query })
        });
        
        const data = await response.json();
        
        if (data.results && data.results.length > 0) {
            const first = data.results[0];
            await fetchWeatherData(first.latitude, first.longitude);
            input.value = '';
        } else {
            showError('No locations found. Try another search.');
        }
        
    } catch (error) {
        console.error('Search error:', error);
        showError('Search failed. Please try again.');
    }
}

async function refreshWeather() {
    if (!currentWeatherData) {
        loadWeather();
        return;
    }
    
    const location = currentWeatherData.location;
    if (location) {
        await fetchWeatherData(location.latitude, location.longitude);
    }
}

function renderWeatherData(data) {
    const mainContent = document.getElementById('mainContent');
    
    switch (currentTab) {
        case 'overview':
            mainContent.innerHTML = renderOverviewTab(data);
            break;
        case 'hourly':
            mainContent.innerHTML = renderHourlyTab(data);
            loadHourlyForecast(data.location.latitude, data.location.longitude);
            break;
        case 'forecast':
            mainContent.innerHTML = renderForecastTab(data);
            load7DayForecast(data.location.latitude, data.location.longitude);
            break;
        case 'details':
            mainContent.innerHTML = renderDetailsTab(data);
            break;
    }
}

function renderOverviewTab(data) {
    const { current_weather, location, weather_tips, forecast } = data;
    const temp = getTemperature(current_weather.temperature_celsius);
    const feelsLike = getTemperature(current_weather.feels_like_celsius);
    
    return `
        <div class="weather-card">
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 24px;">
                <div>
                    <h2 style="font-size: 2rem; font-weight: 800; color: var(--text-1); margin-bottom: 4px;">
                        ${location.city}
                    </h2>
                    <p style="color: var(--text-3); font-size: 1rem;">
                        ${location.locality} â€¢ ${location.country}
                    </p>
                </div>
                <div style="text-align: right;">
                    <div style="font-size: 3.5rem; font-weight: 900; color: var(--primary); line-height: 1;">
                        ${temp}
                    </div>
                    <p style="color: var(--text-3); margin-top: 4px;">
                        Feels like ${feelsLike}
                    </p>
                </div>
            </div>
            
            <div style="display: flex; align-items: center; gap: 16px; padding: 20px; background: var(--bg-2); border-radius: var(--radius); margin-bottom: 20px;">
                <i class="fas ${getWeatherIcon(current_weather.condition)} fa-3x" style="color: var(--primary);"></i>
                <div>
                    <h3 style="font-size: 1.5rem; font-weight: 700; color: var(--text-1);">
                        ${current_weather.condition}
                    </h3>
                    <p style="color: var(--text-2);">
                        ${current_weather.description}
                    </p>
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px;">
                ${renderMetricCard('ğŸ’§', 'Humidity', `${current_weather.humidity_percent}%`)}
                ${renderMetricCard('ğŸ’¨', 'Wind', `${current_weather.wind_speed_kmh} km/h`)}
                ${renderMetricCard('ğŸŒ¡ï¸', 'Pressure', `${current_weather.pressure_mb} mb`)}
                ${renderMetricCard('ğŸ‘ï¸', 'Visibility', `${current_weather.visibility_km} km`)}
                ${renderMetricCard('â˜€ï¸', 'UV Index', current_weather.uv_index)}
                ${renderMetricCard('â˜ï¸', 'Cloud Cover', `${current_weather.cloud_cover_percent}%`)}
            </div>
        </div>
        
        <div class="weather-card">
            <h3 style="font-size: 1.3rem; font-weight: 700; color: var(--text-1); margin-bottom: 16px;">
                <i class="fas fa-lightbulb"></i> Weather Tips
            </h3>
            <div style="display: flex; flex-direction: column; gap: 12px;">
                ${weather_tips.map(tip => `
                    <div style="padding: 12px 16px; background: var(--bg-2); border-radius: var(--radius); border-left: 4px solid var(--primary);">
                        ${tip}
                    </div>
                `).join('')}
            </div>
        </div>
        
        <div class="weather-card">
            <h3 style="font-size: 1.3rem; font-weight: 700; color: var(--text-1); margin-bottom: 16px;">
                <i class="fas fa-calendar-days"></i> 3-Day Outlook
            </h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                ${renderForecastCard('Today', forecast.today, 'fa-sun')}
                ${renderForecastCard('Tomorrow', forecast.tomorrow, 'fa-cloud-sun')}
                ${renderForecastCard('Day After', forecast.day_after, 'fa-cloud')}
            </div>
        </div>
    `;
}

function renderHourlyTab(data) {
    return `
        <div class="weather-card">
            <h3 style="font-size: 1.3rem; font-weight: 700; color: var(--text-1); margin-bottom: 20px;">
                <i class="fas fa-clock"></i> 24-Hour Forecast
            </h3>
            <div id="hourlyContent">
                <div class="loader-container">
                    <div class="spinner"></div>
                    <p class="loader-text">Loading hourly forecast...</p>
                </div>
            </div>
        </div>
    `;
}

async function loadHourlyForecast(lat, lon) {
    try {
        const response = await fetch(`${API_BASE_URL}/api/hourly`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ latitude: lat, longitude: lon })
        });
        
        const data = await response.json();
        const hourlyContent = document.getElementById('hourlyContent');
        
        hourlyContent.innerHTML = `
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 16px;">
                ${data.hourly_forecast.slice(0, 12).map(hour => `
                    <div style="padding: 16px; background: var(--bg-2); border-radius: var(--radius); text-align: center;">
                        <div style="font-weight: 600; color: var(--text-1); margin-bottom: 8px;">
                            ${hour.hour}
                        </div>
                        <i class="fas ${getWeatherIcon(hour.condition)} fa-2x" style="color: var(--primary); margin: 8px 0;"></i>
                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--primary); margin: 8px 0;">
                            ${getTemperature(hour.temperature_celsius)}
                        </div>
                        <div style="color: var(--text-3); font-size: 0.875rem;">
                            ğŸ’§ ${hour.precipitation_chance}%
                        </div>
                    </div>
                `).join('')}
            </div>
        `;
        
    } catch (error) {
        console.error('Hourly forecast error:', error);
        document.getElementById('hourlyContent').innerHTML = `
            <p style="text-align: center; color: var(--text-3);">
                Failed to load hourly forecast
            </p>
        `;
    }
}

function renderForecastTab(data) {
    return `
        <div class="weather-card">
            <h3 style="font-size: 1.3rem; font-weight: 700; color: var(--text-1); margin-bottom: 20px;">
                <i class="fas fa-calendar-week"></i> 7-Day Forecast
            </h3>
            <div id="forecastContent">
                <div class="loader-container">
                    <div class="spinner"></div>
                    <p class="loader-text">Loading forecast...</p>
                </div>
            </div>
        </div>
    `;
}

async function load7DayForecast(lat, lon) {
    try {
        const response = await fetch(`${API_BASE_URL}/api/forecast`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ latitude: lat, longitude: lon })
        });
        
        const data = await response.json();
        const forecastContent = document.getElementById('forecastContent');
        
        if (data.forecast && data.forecast.length > 0) {
            forecastContent.innerHTML = `
                <div style="display: flex; flex-direction: column; gap: 12px;">
                    ${data.forecast.map(day => `
                        <div style="display: flex; align-items: center; justify-content: space-between; padding: 16px; background: var(--bg-2); border-radius: var(--radius);">
                            <div style="display: flex; align-items: center; gap: 16px; flex: 1;">
                                <i class="fas ${getWeatherIcon(day.condition)} fa-2x" style="color: var(--primary); width: 40px;"></i>
                                <div>
                                    <div style="font-weight: 600; color: var(--text-1);">${day.day}</div>
                                    <div style="color: var(--text-3); font-size: 0.875rem;">${day.condition}</div>
                                </div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 16px;">
                                <div style="color: var(--text-3);">ğŸ’§ ${day.rain_chance}%</div>
                                <div style="font-size: 1.1rem; color: var(--text-2);">${getTemperature(day.min_temp_c)}</div>
                                <div style="font-size: 1.3rem; font-weight: 700; color: var(--primary);">${getTemperature(day.max_temp_c)}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }
    } catch (error) {
        console.error('7-day forecast error:', error);
        document.getElementById('forecastContent').innerHTML = '<p style="text-align: center; color: var(--text-3);">Failed to load forecast</p>';
    }
}

function renderDetailsTab(data) {
    const { current_weather, sun_times } = data;
    
    return `
        <div class="weather-card">
            <h3 style="font-size: 1.3rem; font-weight: 700; color: var(--text-1); margin-bottom: 20px;">
                <i class="fas fa-chart-line"></i> Detailed Metrics
            </h3>
            
            <div style="display: grid; gap: 24px;">
                <div>
                    <h4 style="font-weight: 600; color: var(--text-1); margin-bottom: 12px;">ğŸŒ¡ï¸ Temperature</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                        ${renderDetailItem('Current', getTemperature(current_weather.temperature_celsius))}
                        ${renderDetailItem('Feels Like', getTemperature(current_weather.feels_like_celsius))}
                        ${renderDetailItem('Fahrenheit', `${current_weather.temperature_fahrenheit}Â°F`)}
                    </div>
                </div>
                
                <div>
                    <h4 style="font-weight: 600; color: var(--text-1); margin-bottom: 12px;">ğŸ’¨ Wind</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                        ${renderDetailItem('Speed', `${current_weather.wind_speed_kmh} km/h`)}
                        ${renderDetailItem('Direction', current_weather.wind_direction)}
                    </div>
                </div>
                
                <div>
                    <h4 style="font-weight: 600; color: var(--text-1); margin-bottom: 12px;">ğŸŒ Atmospheric</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                        ${renderDetailItem('Pressure', `${current_weather.pressure_mb} mb`)}
                        ${renderDetailItem('Humidity', `${current_weather.humidity_percent}%`)}
                        ${renderDetailItem('Visibility', `${current_weather.visibility_km} km`)}
                        ${renderDetailItem('Cloud Cover', `${current_weather.cloud_cover_percent}%`)}
                    </div>
                </div>
                
                <div>
                    <h4 style="font-weight: 600; color: var(--text-1); margin-bottom: 12px;">â˜€ï¸ Sun & Moon</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                        ${renderDetailItem('Sunrise', sun_times.sunrise)}
                        ${renderDetailItem('Sunset', sun_times.sunset)}
                        ${renderDetailItem('Moon Phase', sun_times.moon_phase)}
                        ${renderDetailItem('UV Index', current_weather.uv_index)}
                    </div>
                </div>
            </div>
        </div>
    `;
}

function renderMetricCard(icon, label, value) {
    return `
        <div style="padding: 16px; background: var(--bg-2); border-radius: var(--radius); text-align: center;">
            <div style="font-size: 2rem; margin-bottom: 8px;">${icon}</div>
            <div style="color: var(--text-3); font-size: 0.875rem; margin-bottom: 4px;">${label}</div>
            <div style="font-size: 1.2rem; font-weight: 700; color: var(--text-1);">${value}</div>
        </div>
    `;
}

function renderForecastCard(day, description, icon) {
    return `
        <div style="padding: 20px; background: var(--bg-2); border-radius: var(--radius); text-align: center;">
            <i class="fas ${icon} fa-3x" style="color: var(--primary); margin-bottom: 12px;"></i>
            <div style="font-weight: 600; color: var(--text-1); margin-bottom: 8px;">${day}</div>
            <div style="color: var(--text-2); font-size: 0.875rem;">${description}</div>
        </div>
    `;
}

function renderDetailItem(label, value) {
    return `
        <div style="padding: 12px; background: var(--bg-2); border-radius: var(--radius);">
            <div style="color: var(--text-3); font-size: 0.875rem; margin-bottom: 4px;">${label}</div>
            <div style="font-weight: 600; color: var(--text-1);">${value}</div>
        </div>
    `;
}

function getTemperature(celsius) {
    if (temperatureUnit === 'F') {
        const fahrenheit = Math.round((celsius * 9/5) + 32);
        return `${fahrenheit}Â°F`;
    }
    return `${Math.round(celsius)}Â°C`;
}

function getWeatherIcon(condition) {
    if (!condition) return 'fa-cloud';
    const c = condition.toLowerCase();
    if (c.includes('clear') || c.includes('sunny')) return 'fa-sun';
    if (c.includes('rain')) return 'fa-cloud-rain';
    if (c.includes('snow')) return 'fa-snowflake';
    if (c.includes('cloud')) return 'fa-cloud';
    if (c.includes('storm') || c.includes('thunder')) return 'fa-bolt';
    if (c.includes('fog') || c.includes('mist')) return 'fa-smog';
    if (c.includes('wind')) return 'fa-wind';
    return 'fa-cloud';
}

function showLoader(message = 'Loading...') {
    const mainContent = document.getElementById('mainContent');
    mainContent.innerHTML = `
        <div class="loader-container">
            <div class="spinner"></div>
            <p class="loader-text">${message}</p>
        </div>
    `;
}

function showError(message) {
    const mainContent = document.getElementById('mainContent');
    mainContent.innerHTML = `
        <div class="weather-card" style="text-align: center; padding: 60px 20px;">
            <i class="fas fa-exclamation-triangle fa-4x" style="color: var(--danger); margin-bottom: 20px;"></i>
            <h3 style="color: var(--text-1); margin-bottom: 12px;">Oops!</h3>
            <p style="color: var(--text-2); margin-bottom: 24px;">${message}</p>
            <button onclick="loadWeather()" style="padding: 12px 24px; background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; border: none; border-radius: var(--radius); cursor: pointer; font-weight: 600;">
                Try Again
            </button>
        </div>
    `;
}

function toggleChat() {
    const panel = document.getElementById('chatPanel');
    panel.classList.toggle('active');
}

async function sendChat() {
    const input = document.getElementById('chatInput');
    const message = input.value.trim();
    
    if (!message || !currentWeatherData) return;
    
    addChatMessage(message, 'user');
    input.value = '';
    
    const typingId = addChatMessage('Thinking...', 'bot', true);
    
    try {
        const response = await fetch(`${API_BASE_URL}/api/chatbot`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                message: message,
                weather_data: currentWeatherData
            })
        });
        
        const data = await response.json();
        
        document.getElementById(typingId)?.remove();
        addChatMessage(data.response, 'bot');
        
    } catch (error) {
        document.getElementById(typingId)?.remove();
        addChatMessage('Sorry, I encountered an error. Please try again.', 'bot');
    }
}

function addChatMessage(text, sender, isTyping = false) {
    const messagesDiv = document.getElementById('chatMessages');
    const messageId = `msg-${Date.now()}`;
    
    const avatar = sender === 'bot' ? 
        '<div class="chat-avatar bot-avatar"><i class="fas fa-robot"></i></div>' :
        '<div class="chat-avatar user-avatar"><i class="fas fa-user"></i></div>';
    
    const messageHtml = `
        <div class="chat-msg ${sender}" id="${messageId}">
            ${avatar}
            <div class="chat-bubble">${text}</div>
        </div>
    `;
    
    messagesDiv.insertAdjacentHTML('beforeend', messageHtml);
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
    
    return messageId;
}

async function clearCache() {
    try {
        await fetch(`${API_BASE_URL}/api/cache-clear`, { method: 'POST' });
        alert('Cache cleared successfully!');
    } catch (error) {
        alert('Failed to clear cache');
    }
}

document.addEventListener('DOMContentLoaded', () => {
    const chatInput = document.getElementById('chatInput');
    if (chatInput) {
        chatInput.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 100) + 'px';
        });
    }
});

console.log('âœ… FlintWeatherAI Frontend Loaded (GitHub Pages + Render Backend)');


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FILE: templates/index.html
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="FlintWeatherAI - Modern AI-powered weather application">
    <meta name="theme-color" content="#7c3aed">
    <link rel="manifest" href="/manifest.json">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <title>FlintWeatherAI - Smart Weather Forecasting</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="app-container">
        <!-- Hero Header -->
        <header class="hero-header">
            <div class="header-gradient"></div>
            <div class="header-content">
                <div class="brand-section">
                    <div class="brand-logo">
                        <i class="fas fa-bolt-lightning"></i>
                    </div>
                    <div class="brand-text">
                        <h1 class="brand-title">FlintWeather<span class="brand-ai">AI</span></h1>
                        <p class="brand-tagline">Smart Weather â€¢ Real-time AI</p>
                    </div>
                </div>
                <div class="header-actions">
                    <button class="action-btn" onclick="toggleTheme()" title="Toggle Theme">
                        <i class="fas fa-moon"></i>
                    </button>
                    <button class="action-btn" onclick="refreshWeather()" title="Refresh">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                    <button class="action-btn" onclick="toggleSettings()" title="Settings">
                        <i class="fas fa-sliders-h"></i>
                    </button>
                </div>
            </div>
            
            <!-- Search Bar -->
            <div class="search-wrapper">
                <div class="search-box">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" class="search-input" id="searchInput" 
                           placeholder="Search for cities worldwide..." 
                           autocomplete="off"
                           onkeypress="if(event.key==='Enter') performSearch()">
                    <button class="search-btn-inline" onclick="performSearch()">
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
                <button class="location-btn" onclick="loadWeather()" title="Use my location">
                    <i class="fas fa-location-crosshairs"></i>
                </button>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="nav-tabs">
            <button class="nav-tab active" data-tab="overview" onclick="switchTab('overview')">
                <i class="fas fa-home"></i>
                <span>Overview</span>
            </button>
            <button class="nav-tab" data-tab="hourly" onclick="switchTab('hourly')">
                <i class="fas fa-clock"></i>
                <span>Hourly</span>
            </button>
            <button class="nav-tab" data-tab="forecast" onclick="switchTab('forecast')">
                <i class="fas fa-calendar-week"></i>
                <span>7 Days</span>
            </button>
            <button class="nav-tab" data-tab="details" onclick="switchTab('details')">
                <i class="fas fa-chart-line"></i>
                <span>Details</span>
            </button>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content" id="mainContent">
            <div class="loader-container">
                <div class="spinner"></div>
                <p class="loader-text">Loading weather data...</p>
            </div>
        </main>

        <!-- AI Chatbot Widget -->
        <div class="chat-widget">
            <button class="chat-fab" onclick="toggleChat()">
                <i class="fas fa-robot"></i>
            </button>
            <div class="chat-panel" id="chatPanel">
                <div class="chat-header">
                    <div class="chat-header-info">
                        <i class="fas fa-robot"></i>
                        <div>
                            <h4>AI Weather Assistant</h4>
                            <p class="chat-status">Online â€¢ Ask anything</p>
                        </div>
                    </div>
                    <button class="chat-close" onclick="toggleChat()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="chat-messages" id="chatMessages">
                    <div class="chat-msg bot">
                        <div class="chat-avatar bot-avatar">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div class="chat-bubble">
                            ğŸ‘‹ Hello! I'm your AI weather assistant. Ask me anything about the weather!
                        </div>
                    </div>
                </div>
                <div class="chat-input-area">
                    <textarea class="chat-input" id="chatInput" 
                              placeholder="Ask about weather..." 
                              rows="1"
                              onkeypress="if(event.key==='Enter' && !event.shiftKey) { event.preventDefault(); sendChat(); }"></textarea>
                    <button class="chat-send-btn" onclick="sendChat()">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Settings Panel -->
        <aside class="settings-panel" id="settingsPanel">
            <div class="settings-header">
                <h3><i class="fas fa-sliders-h"></i> Settings</h3>
                <button class="settings-close" onclick="toggleSettings()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="settings-content">
                <div class="setting-group">
                    <label class="setting-label">
                        <i class="fas fa-temperature-three-quarters"></i>
                        Temperature Unit
                    </label>
                    <select class="setting-select" id="unitSelect" onchange="changeUnit(this.value)">
                        <option value="C">Celsius (Â°C)</option>
                        <option value="F">Fahrenheit (Â°F)</option>
                    </select>
                </div>
                <div class="setting-group">
                    <label class="setting-label">
                        <i class="fas fa-palette"></i>
                        Theme
                    </label>
                    <div class="theme-toggle" id="themeToggle" onclick="toggleTheme()">
                        <div class="theme-toggle-track">
                            <div class="theme-toggle-thumb"></div>
                        </div>
                        <span class="theme-label">Dark Mode</span>
                    </div>
                </div>
                <div class="setting-group">
                    <button class="setting-btn danger" onclick="clearCache()">
                        <i class="fas fa-trash"></i>
                        Clear Cache
                    </button>
                </div>
            </div>
        </aside>
    </div>

    <script src="/static/js/app.js"></script>
</body>
</html>


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FILE: docs/index.html
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="FlintWeatherAI - Modern AI-powered weather application">
    <meta name="theme-color" content="#7c3aed">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <title>FlintWeatherAI - Smart Weather Forecasting</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="app-container">
        <!-- Hero Header -->
        <header class="hero-header">
            <div class="header-gradient"></div>
            <div class="header-content">
                <div class="brand-section">
                    <div class="brand-logo">
                        <i class="fas fa-bolt-lightning"></i>
                    </div>
                    <div class="brand-text">
                        <h1 class="brand-title">FlintWeather<span class="brand-ai">AI</span></h1>
                        <p class="brand-tagline">Smart Weather â€¢ Real-time AI</p>
                    </div>
                </div>
                <div class="header-actions">
                    <button class="action-btn" onclick="toggleTheme()" title="Toggle Theme">
                        <i class="fas fa-moon"></i>
                    </button>
                    <button class="action-btn" onclick="refreshWeather()" title="Refresh">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                    <button class="action-btn" onclick="toggleSettings()" title="Settings">
                        <i class="fas fa-sliders-h"></i>
                    </button>
                </div>
            </div>
            
            <!-- Search Bar -->
            <div class="search-wrapper">
                <div class="search-box">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" class="search-input" id="searchInput" 
                           placeholder="Search for cities worldwide..." 
                           autocomplete="off"
                           onkeypress="if(event.key==='Enter') performSearch()">
                    <button class="search-btn-inline" onclick="performSearch()">
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
                <button class="location-btn" onclick="loadWeather()" title="Use my location">
                    <i class="fas fa-location-crosshairs"></i>
                </button>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="nav-tabs">
            <button class="nav-tab active" data-tab="overview" onclick="switchTab('overview')">
                <i class="fas fa-home"></i>
                <span>Overview</span>
            </button>
            <button class="nav-tab" data-tab="hourly" onclick="switchTab('hourly')">
                <i class="fas fa-clock"></i>
                <span>Hourly</span>
            </button>
            <button class="nav-tab" data-tab="forecast" onclick="switchTab('forecast')">
                <i class="fas fa-calendar-week"></i>
                <span>7 Days</span>
            </button>
            <button class="nav-tab" data-tab="details" onclick="switchTab('details')">
                <i class="fas fa-chart-line"></i>
                <span>Details</span>
            </button>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content" id="mainContent">
            <div class="loader-container">
                <div class="spinner"></div>
                <p class="loader-text">Loading weather data...</p>
            </div>
        </main>

        <!-- AI Chatbot Widget -->
        <div class="chat-widget">
            <button class="chat-fab" onclick="toggleChat()">
                <i class="fas fa-robot"></i>
            </button>
            <div class="chat-panel" id="chatPanel">
                <div class="chat-header">
                    <div class="chat-header-info">
                        <i class="fas fa-robot"></i>
                        <div>
                            <h4>AI Weather Assistant</h4>
                            <p class="chat-status">Online â€¢ Ask anything</p>
                        </div>
                    </div>
                    <button class="chat-close" onclick="toggleChat()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="chat-messages" id="chatMessages">
                    <div class="chat-msg bot">
                        <div class="chat-avatar bot-avatar">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div class="chat-bubble">
                            ğŸ‘‹ Hello! I'm your AI weather assistant. Ask me anything about the weather!
                        </div>
                    </div>
                </div>
                <div class="chat-input-area">
                    <textarea class="chat-input" id="chatInput" 
                              placeholder="Ask about weather..." 
                              rows="1"
                              onkeypress="if(event.key==='Enter' && !event.shiftKey) { event.preventDefault(); sendChat(); }"></textarea>
                    <button class="chat-send-btn" onclick="sendChat()">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Settings Panel -->
        <aside class="settings-panel" id="settingsPanel">
            <div class="settings-header">
                <h3><i class="fas fa-sliders-h"></i> Settings</h3>
                <button class="settings-close" onclick="toggleSettings()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="settings-content">
                <div class="setting-group">
                    <label class="setting-label">
                        <i class="fas fa-temperature-three-quarters"></i>
                        Temperature Unit
                    </label>
                    <select class="setting-select" id="unitSelect" onchange="changeUnit(this.value)">
                        <option value="C">Celsius (Â°C)</option>
                        <option value="F">Fahrenheit (Â°F)</option>
                    </select>
                </div>
                <div class="setting-group">
                    <label class="setting-label">
                        <i class="fas fa-palette"></i>
                        Theme
                    </label>
                    <div class="theme-toggle" id="themeToggle" onclick="toggleTheme()">
                        <div class="theme-toggle-track">
                            <div class="theme-toggle-thumb"></div>
                        </div>
                        <span class="theme-label">Dark Mode</span>
                    </div>
                </div>
                <div class="setting-group">
                    <button class="setting-btn danger" onclick="clearCache()">
                        <i class="fas fa-trash"></i>
                        Clear Cache
                    </button>
                </div>
            </div>
        </aside>
    </div>

    <script src="js/app.js"></script>
</body>
</html>


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FILE: static/css/style.css
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

:root {
    --primary: #7c3aed;
    --primary-dark: #6d28d9;
    --secondary: #ec4899;
    --accent: #f59e0b;
    --success: #10b981;
    --danger: #ef4444;
    --bg-1: #ffffff;
    --bg-2: #f8fafc;
    --bg-3: #f1f5f9;
    --text-1: #0f172a;
    --text-2: #475569;
    --text-3: #94a3b8;
    --border: #e2e8f0;
    --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
    --shadow: 0 4px 6px rgba(0,0,0,0.07);
    --shadow-lg: 0 10px 15px rgba(0,0,0,0.1);
    --shadow-xl: 0 20px 25px rgba(0,0,0,0.15);
    --radius-sm: 8px;
    --radius: 16px;
    --radius-lg: 24px;
    --radius-full: 9999px;
}

[data-theme="dark"] {
    --primary: #a78bfa;
    --bg-1: #0f172a;
    --bg-2: #1e293b;
    --bg-3: #334155;
    --text-1: #f1f5f9;
    --text-2: #cbd5e1;
    --text-3: #94a3b8;
    --border: #334155;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    color: var(--text-1);
    min-height: 100vh;
    line-height: 1.6;
    overflow-x: hidden;
}

.app-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 20px;
}

/* Hero Header */
.hero-header {
    background: var(--bg-1);
    border-radius: var(--radius-lg);
    padding: 32px;
    margin-bottom: 24px;
    box-shadow: var(--shadow-xl);
    position: relative;
    overflow: hidden;
    animation: slideDown 0.6s ease;
}

@keyframes slideDown {
    from { opacity: 0; transform: translateY(-30px); }
    to { opacity: 1; transform: translateY(0); }
}

.header-gradient {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 6px;
    background: linear-gradient(90deg, var(--primary), var(--secondary), var(--accent));
}

.header-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 28px;
}

.brand-section {
    display: flex;
    align-items: center;
    gap: 16px;
}

.brand-logo {
    width: 64px;
    height: 64px;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    border-radius: var(--radius);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
    color: white;
    box-shadow: var(--shadow-lg);
}

.brand-title {
    font-size: 2rem;
    font-weight: 900;
    color: var(--text-1);
    letter-spacing: -0.5px;
}

.brand-ai {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.brand-tagline {
    font-size: 0.875rem;
    color: var(--text-3);
    font-weight: 500;
}

.header-actions {
    display: flex;
    gap: 12px;
}

.action-btn {
    width: 48px;
    height: 48px;
    border: none;
    background: var(--bg-2);
    color: var(--text-2);
    border-radius: var(--radius);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s cubic-bezier(0.4,0,0.2,1);
    font-size: 1.2rem;
}

.action-btn:hover {
    background: var(--primary);
    color: white;
    transform: translateY(-2px);
    box-shadow: var(--shadow);
}

/* Search */
.search-wrapper {
    display: flex;
    gap: 12px;
    align-items: center;
}

.search-box {
    flex: 1;
    position: relative;
    display: flex;
    align-items: center;
}

.search-icon {
    position: absolute;
    left: 20px;
    color: var(--text-3);
    font-size: 1.1rem;
}

.search-input {
    width: 100%;
    padding: 16px 60px 16px 52px;
    border: 2px solid var(--border);
    border-radius: var(--radius-full);
    background: var(--bg-1);
    color: var(--text-1);
    font-size: 1rem;
    font-family: inherit;
    outline: none;
    transition: all 0.3s;
}

.search-input:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 4px rgba(124,58,237,0.1);
}

.search-btn-inline {
    position: absolute;
    right: 6px;
    width: 44px;
    height: 44px;
    border: none;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    border-radius: var(--radius-full);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s;
}

.search-btn-inline:hover {
    transform: scale(1.05);
    box-shadow: var(--shadow);
}

.location-btn {
    width: 56px;
    height: 56px;
    border: none;
    background: var(--bg-2);
    color: var(--text-2);
    border-radius: var(--radius);
    cursor: pointer;
    font-size: 1.3rem;
    transition: all 0.3s;
}

.location-btn:hover {
    background: var(--success);
    color: white;
    transform: translateY(-2px);
}

/* Navigation Tabs */
.nav-tabs {
    background: var(--bg-1);
    border-radius: var(--radius-lg);
    padding: 8px;
    margin-bottom: 24px;
    display: flex;
    gap: 8px;
    box-shadow: var(--shadow-lg);
    overflow-x: auto;
}

.nav-tab {
    flex: 1;
    min-width: 120px;
    padding: 14px 20px;
    border: none;
    background: transparent;
    color: var(--text-3);
    border-radius: var(--radius);
    cursor: pointer;
    font-weight: 600;
    font-family: inherit;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    transition: all 0.3s;
    white-space: nowrap;
}

.nav-tab i {
    font-size: 1.2rem;
}

.nav-tab:hover:not(.active) {
    background: var(--bg-2);
    color: var(--text-1);
}

.nav-tab.active {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    box-shadow: var(--shadow);
}

/* Main Content */
.main-content {
    animation: fadeIn 0.5s ease;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

/* Loader */
.loader-container {
    text-align: center;
    padding: 80px 20px;
}

.spinner {
    width: 60px;
    height: 60px;
    border: 4px solid var(--border);
    border-top-color: var(--primary);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
    margin: 0 auto 20px;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

.loader-text {
    color: var(--text-2);
    font-size: 1.1rem;
}

/* Cards */
.weather-card {
    background: var(--bg-1);
    border-radius: var(--radius-lg);
    padding: 28px;
    margin-bottom: 24px;
    box-shadow: var(--shadow-lg);
    transition: all 0.3s;
    animation: slideUp 0.5s ease;
}

@keyframes slideUp {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
}

.weather-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-xl);
}

/* Chat Widget */
.chat-widget {
    position: fixed;
    bottom: 24px;
    right: 24px;
    z-index: 1000;
}

.chat-fab {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    border: none;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    font-size: 1.8rem;
    cursor: pointer;
    box-shadow: var(--shadow-xl);
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
}

.chat-fab:hover {
    transform: scale(1.1) rotate(15deg);
}

.chat-panel {
    display: none;
    position: fixed;
    bottom: 100px;
    right: 24px;
    width: 400px;
    max-width: calc(100vw - 48px);
    height: 600px;
    max-height: calc(100vh - 150px);
    background: var(--bg-1);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-xl);
    flex-direction: column;
    overflow: hidden;
    border: 1px solid var(--border);
    animation: chatSlide 0.4s ease;
}

@keyframes chatSlide {
    from { opacity: 0; transform: translateY(30px) scale(0.9); }
    to { opacity: 1; transform: translateY(0) scale(1); }
}

.chat-panel.active {
    display: flex;
}

.chat-header {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    padding: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.chat-header-info {
    display: flex;
    align-items: center;
    gap: 12px;
}

.chat-header-info i {
    font-size: 1.5rem;
}

.chat-header h4 {
    font-size: 1.1rem;
    font-weight: 700;
}

.chat-status {
    font-size: 0.85rem;
    opacity: 0.9;
}

.chat-close {
    width: 36px;
    height: 36px;
    border: none;
    background: rgba(255,255,255,0.2);
    color: white;
    border-radius: 50%;
    cursor: pointer;
    font-size: 1.1rem;
    transition: all 0.3s;
}

.chat-close:hover {
    background: rgba(255,255,255,0.3);
    transform: rotate(90deg);
}

.chat-messages {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
    background: var(--bg-2);
}

.chat-msg {
    display: flex;
    gap: 12px;
    margin-bottom: 16px;
    animation: msgFade 0.3s ease;
}

@keyframes msgFade {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.chat-msg.user {
    flex-direction: row-reverse;
}

.chat-avatar {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.bot-avatar {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
}

.user-avatar {
    background: var(--accent);
    color: white;
}

.chat-bubble {
    max-width: 75%;
    padding: 12px 16px;
    border-radius: 18px;
    line-height: 1.5;
}

.chat-msg.bot .chat-bubble {
    background: var(--bg-1);
    color: var(--text-1);
    border-bottom-left-radius: 4px;
}

.chat-msg.user .chat-bubble {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    border-bottom-right-radius: 4px;
}

.chat-input-area {
    display: flex;
    padding: 16px;
    gap: 12px;
    border-top: 1px solid var(--border);
    background: var(--bg-1);
}

.chat-input {
    flex: 1;
    padding: 12px 16px;
    border: 1px solid var(--border);
    border-radius: var(--radius);
    background: var(--bg-1);
    color: var(--text-1);
    font-family: inherit;
    resize: none;
    outline: none;
    transition: all 0.3s;
    max-height: 100px;
}

.chat-input:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(124,58,237,0.1);
}

.chat-send-btn {
    width: 48px;
    height: 48px;
    border: none;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    border-radius: var(--radius);
    cursor: pointer;
    font-size: 1.2rem;
    transition: all 0.3s;
}

.chat-send-btn:hover {
    transform: scale(1.05);
    box-shadow: var(--shadow);
}

/* Settings Panel */
.settings-panel {
    position: fixed;
    top: 0;
    right: -400px;
    width: 380px;
    max-width: 90vw;
    height: 100vh;
    background: var(--bg-1);
    box-shadow: var(--shadow-xl);
    padding: 24px;
    overflow-y: auto;
    z-index: 1001;
    transition: right 0.4s ease;
}

.settings-panel.active {
    right: 0;
}

.settings-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 32px;
    padding-bottom: 20px;
    border-bottom: 2px solid var(--border);
}

.settings-header h3 {
    font-size: 1.5rem;
    display: flex;
    align-items: center;
    gap: 12px;
}

.settings-close {
    width: 40px;
    height: 40px;
    border: none;
    background: var(--bg-2);
    color: var(--text-2);
    border-radius: 50%;
    cursor: pointer;
    font-size: 1.2rem;
    transition: all 0.3s;
}

.settings-close:hover {
    background: var(--danger);
    color: white;
}

.setting-group {
    margin-bottom: 28px;
}

.setting-label {
    display: flex;
    align-items: center;
    gap: 10px;
    font-weight: 600;
    margin-bottom: 12px;
    color: var(--text-1);
}

.setting-select {
    width: 100%;
    padding: 14px 16px;
    border: 2px solid var(--border);
    border-radius: var(--radius);
    background: var(--bg-1);
    color: var(--text-1);
    font-family: inherit;
    font-size: 1rem;
    cursor: pointer;
    outline: none;
    transition: all 0.3s;
}

.setting-select:focus {
    border-color: var(--primary);
}

.theme-toggle {
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 14px;
    background: var(--bg-2);
    border-radius: var(--radius);
    cursor: pointer;
    transition: all 0.3s;
}

.theme-toggle:hover {
    background: var(--bg-3);
}

.theme-toggle-track {
    position: relative;
    width: 56px;
    height: 30px;
    background: var(--bg-3);
    border-radius: var(--radius-full);
    transition: all 0.3s;
}

.theme-toggle-track.active {
    background: var(--primary);
}

.theme-toggle-thumb {
    position: absolute;
    top: 3px;
    left: 3px;
    width: 24px;
    height: 24px;
    background: white;
    border-radius: 50%;
    transition: all 0.3s;
}

.theme-toggle-track.active .theme-toggle-thumb {
    transform: translateX(26px);
}

.setting-btn {
    width: 100%;
    padding: 14px 20px;
    border: none;
    background: var(--bg-2);
    color: var(--text-1);
    border-radius: var(--radius);
    font-family: inherit;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    transition: all 0.3s;
}

.setting-btn:hover {
    background: var(--bg-3);
}

.setting-btn.danger:hover {
    background: var(--danger);
    color: white;
}

/* Responsive */
@media (max-width: 768px) {
    .app-container {
        padding: 12px;
    }
    
    .hero-header {
        padding: 20px;
    }
    
    .header-content {
        flex-direction: column;
        gap: 20px;
        align-items: flex-start;
    }
    
    .brand-title {
        font-size: 1.5rem;
    }
    
    .nav-tab span {
        display: none;
    }
    
    .chat-panel {
        width: calc(100vw - 32px);
        right: 16px;
        bottom: 90px;
    }
}


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FILE: docs/css/style.css
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

:root {
    --primary: #7c3aed;
    --primary-dark: #6d28d9;
    --secondary: #ec4899;
    --accent: #f59e0b;
    --success: #10b981;
    --danger: #ef4444;
    --bg-1: #ffffff;
    --bg-2: #f8fafc;
    --bg-3: #f1f5f9;
    --text-1: #0f172a;
    --text-2: #475569;
    --text-3: #94a3b8;
    --border: #e2e8f0;
    --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
    --shadow: 0 4px 6px rgba(0,0,0,0.07);
    --shadow-lg: 0 10px 15px rgba(0,0,0,0.1);
    --shadow-xl: 0 20px 25px rgba(0,0,0,0.15);
    --radius-sm: 8px;
    --radius: 16px;
    --radius-lg: 24px;
    --radius-full: 9999px;
}

[data-theme="dark"] {
    --primary: #a78bfa;
    --bg-1: #0f172a;
    --bg-2: #1e293b;
    --bg-3: #334155;
    --text-1: #f1f5f9;
    --text-2: #cbd5e1;
    --text-3: #94a3b8;
    --border: #334155;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    color: var(--text-1);
    min-height: 100vh;
    line-height: 1.6;
    overflow-x: hidden;
}

.app-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 20px;
}

/* Hero Header */
.hero-header {
    background: var(--bg-1);
    border-radius: var(--radius-lg);
    padding: 32px;
    margin-bottom: 24px;
    box-shadow: var(--shadow-xl);
    position: relative;
    overflow: hidden;
    animation: slideDown 0.6s ease;
}

@keyframes slideDown {
    from { opacity: 0; transform: translateY(-30px); }
    to { opacity: 1; transform: translateY(0); }
}

.header-gradient {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 6px;
    background: linear-gradient(90deg, var(--primary), var(--secondary), var(--accent));
}

.header-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 28px;
}

.brand-section {
    display: flex;
    align-items: center;
    gap: 16px;
}

.brand-logo {
    width: 64px;
    height: 64px;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    border-radius: var(--radius);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
    color: white;
    box-shadow: var(--shadow-lg);
}

.brand-title {
    font-size: 2rem;
    font-weight: 900;
    color: var(--text-1);
    letter-spacing: -0.5px;
}

.brand-ai {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.brand-tagline {
    font-size: 0.875rem;
    color: var(--text-3);
    font-weight: 500;
}

.header-actions {
    display: flex;
    gap: 12px;
}

.action-btn {
    width: 48px;
    height: 48px;
    border: none;
    background: var(--bg-2);
    color: var(--text-2);
    border-radius: var(--radius);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s cubic-bezier(0.4,0,0.2,1);
    font-size: 1.2rem;
}

.action-btn:hover {
    background: var(--primary);
    color: white;
    transform: translateY(-2px);
    box-shadow: var(--shadow);
}

/* Search */
.search-wrapper {
    display: flex;
    gap: 12px;
    align-items: center;
}

.search-box {
    flex: 1;
    position: relative;
    display: flex;
    align-items: center;
}

.search-icon {
    position: absolute;
    left: 20px;
    color: var(--text-3);
    font-size: 1.1rem;
}

.search-input {
    width: 100%;
    padding: 16px 60px 16px 52px;
    border: 2px solid var(--border);
    border-radius: var(--radius-full);
    background: var(--bg-1);
    color: var(--text-1);
    font-size: 1rem;
    font-family: inherit;
    outline: none;
    transition: all 0.3s;
}

.search-input:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 4px rgba(124,58,237,0.1);
}

.search-btn-inline {
    position: absolute;
    right: 6px;
    width: 44px;
    height: 44px;
    border: none;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    border-radius: var(--radius-full);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s;
}

.search-btn-inline:hover {
    transform: scale(1.05);
    box-shadow: var(--shadow);
}

.location-btn {
    width: 56px;
    height: 56px;
    border: none;
    background: var(--bg-2);
    color: var(--text-2);
    border-radius: var(--radius);
    cursor: pointer;
    font-size: 1.3rem;
    transition: all 0.3s;
}

.location-btn:hover {
    background: var(--success);
    color: white;
    transform: translateY(-2px);
}

/* Navigation Tabs */
.nav-tabs {
    background: var(--bg-1);
    border-radius: var(--radius-lg);
    padding: 8px;
    margin-bottom: 24px;
    display: flex;
    gap: 8px;
    box-shadow: var(--shadow-lg);
    overflow-x: auto;
}

.nav-tab {
    flex: 1;
    min-width: 120px;
    padding: 14px 20px;
    border: none;
    background: transparent;
    color: var(--text-3);
    border-radius: var(--radius);
    cursor: pointer;
    font-weight: 600;
    font-family: inherit;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    transition: all 0.3s;
    white-space: nowrap;
}

.nav-tab i {
    font-size: 1.2rem;
}

.nav-tab:hover:not(.active) {
    background: var(--bg-2);
    color: var(--text-1);
}

.nav-tab.active {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    box-shadow: var(--shadow);
}

/* Main Content */
.main-content {
    animation: fadeIn 0.5s ease;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

/* Loader */
.loader-container {
    text-align: center;
    padding: 80px 20px;
}

.spinner {
    width: 60px;
    height: 60px;
    border: 4px solid var(--border);
    border-top-color: var(--primary);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
    margin: 0 auto 20px;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

.loader-text {
    color: var(--text-2);
    font-size: 1.1rem;
}

/* Cards */
.weather-card {
    background: var(--bg-1);
    border-radius: var(--radius-lg);
    padding: 28px;
    margin-bottom: 24px;
    box-shadow: var(--shadow-lg);
    transition: all 0.3s;
    animation: slideUp 0.5s ease;
}

@keyframes slideUp {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
}

.weather-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-xl);
}

/* Chat Widget */
.chat-widget {
    position: fixed;
    bottom: 24px;
    right: 24px;
    z-index: 1000;
}

.chat-fab {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    border: none;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    font-size: 1.8rem;
    cursor: pointer;
    box-shadow: var(--shadow-xl);
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
}

.chat-fab:hover {
    transform: scale(1.1) rotate(15deg);
}

.chat-panel {
    display: none;
    position: fixed;
    bottom: 100px;
    right: 24px;
    width: 400px;
    max-width: calc(100vw - 48px);
    height: 600px;
    max-height: calc(100vh - 150px);
    background: var(--bg-1);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-xl);
    flex-direction: column;
    overflow: hidden;
    border: 1px solid var(--border);
    animation: chatSlide 0.4s ease;
}

@keyframes chatSlide {
    from { opacity: 0; transform: translateY(30px) scale(0.9); }
    to { opacity: 1; transform: translateY(0) scale(1); }
}

.chat-panel.active {
    display: flex;
}

.chat-header {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    padding: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.chat-header-info {
    display: flex;
    align-items: center;
    gap: 12px;
}

.chat-header-info i {
    font-size: 1.5rem;
}

.chat-header h4 {
    font-size: 1.1rem;
    font-weight: 700;
}

.chat-status {
    font-size: 0.85rem;
    opacity: 0.9;
}

.chat-close {
    width: 36px;
    height: 36px;
    border: none;
    background: rgba(255,255,255,0.2);
    color: white;
    border-radius: 50%;
    cursor: pointer;
    font-size: 1.1rem;
    transition: all 0.3s;
}

.chat-close:hover {
    background: rgba(255,255,255,0.3);
    transform: rotate(90deg);
}

.chat-messages {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
    background: var(--bg-2);
}

.chat-msg {
    display: flex;
    gap: 12px;
    margin-bottom: 16px;
    animation: msgFade 0.3s ease;
}

@keyframes msgFade {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.chat-msg.user {
    flex-direction: row-reverse;
}

.chat-avatar {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.bot-avatar {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
}

.user-avatar {
    background: var(--accent);
    color: white;
}

.chat-bubble {
    max-width: 75%;
    padding: 12px 16px;
    border-radius: 18px;
    line-height: 1.5;
}

.chat-msg.bot .chat-bubble {
    background: var(--bg-1);
    color: var(--text-1);
    border-bottom-left-radius: 4px;
}

.chat-msg.user .chat-bubble {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    border-bottom-right-radius: 4px;
}

.chat-input-area {
    display: flex;
    padding: 16px;
    gap: 12px;
    border-top: 1px solid var(--border);
    background: var(--bg-1);
}

.chat-input {
    flex: 1;
    padding: 12px 16px;
    border: 1px solid var(--border);
    border-radius: var(--radius);
    background: var(--bg-1);
    color: var(--text-1);
    font-family: inherit;
    resize: none;
    outline: none;
    transition: all 0.3s;
    max-height: 100px;
}

.chat-input:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(124,58,237,0.1);
}

.chat-send-btn {
    width: 48px;
    height: 48px;
    border: none;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    border-radius: var(--radius);
    cursor: pointer;
    font-size: 1.2rem;
    transition: all 0.3s;
}

.chat-send-btn:hover {
    transform: scale(1.05);
    box-shadow: var(--shadow);
}

/* Settings Panel */
.settings-panel {
    position: fixed;
    top: 0;
    right: -400px;
    width: 380px;
    max-width: 90vw;
    height: 100vh;
    background: var(--bg-1);
    box-shadow: var(--shadow-xl);
    padding: 24px;
    overflow-y: auto;
    z-index: 1001;
    transition: right 0.4s ease;
}

.settings-panel.active {
    right: 0;
}

.settings-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 32px;
    padding-bottom: 20px;
    border-bottom: 2px solid var(--border);
}

.settings-header h3 {
    font-size: 1.5rem;
    display: flex;
    align-items: center;
    gap: 12px;
}

.settings-close {
    width: 40px;
    height: 40px;
    border: none;
    background: var(--bg-2);
    color: var(--text-2);
    border-radius: 50%;
    cursor: pointer;
    font-size: 1.2rem;
    transition: all 0.3s;
}

.settings-close:hover {
    background: var(--danger);
    color: white;
}

.setting-group {
    margin-bottom: 28px;
}

.setting-label {
    display: flex;
    align-items: center;
    gap: 10px;
    font-weight: 600;
    margin-bottom: 12px;
    color: var(--text-1);
}

.setting-select {
    width: 100%;
    padding: 14px 16px;
    border: 2px solid var(--border);
    border-radius: var(--radius);
    background: var(--bg-1);
    color: var(--text-1);
    font-family: inherit;
    font-size: 1rem;
    cursor: pointer;
    outline: none;
    transition: all 0.3s;
}

.setting-select:focus {
    border-color: var(--primary);
}

.theme-toggle {
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 14px;
    background: var(--bg-2);
    border-radius: var(--radius);
    cursor: pointer;
    transition: all 0.3s;
}

.theme-toggle:hover {
    background: var(--bg-3);
}

.theme-toggle-track {
    position: relative;
    width: 56px;
    height: 30px;
    background: var(--bg-3);
    border-radius: var(--radius-full);
    transition: all 0.3s;
}

.theme-toggle-track.active {
    background: var(--primary);
}

.theme-toggle-thumb {
    position: absolute;
    top: 3px;
    left: 3px;
    width: 24px;
    height: 24px;
    background: white;
    border-radius: 50%;
    transition: all 0.3s;
}

.theme-toggle-track.active .theme-toggle-thumb {
    transform: translateX(26px);
}

.setting-btn {
    width: 100%;
    padding: 14px 20px;
    border: none;
    background: var(--bg-2);
    color: var(--text-1);
    border-radius: var(--radius);
    font-family: inherit;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    transition: all 0.3s;
}

.setting-btn:hover {
    background: var(--bg-3);
}

.setting-btn.danger:hover {
    background: var(--danger);
    color: white;
}

/* Responsive */
@media (max-width: 768px) {
    .app-container {
        padding: 12px;
    }
    
    .hero-header {
        padding: 20px;
    }
    
    .header-content {
        flex-direction: column;
        gap: 20px;
        align-items: flex-start;
    }
    
    .brand-title {
        font-size: 1.5rem;
    }
    
    .nav-tab span {
        display: none;
    }
    
    .chat-panel {
        width: calc(100vw - 32px);
        right: 16px;
        bottom: 90px;
    }
}


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FILE: requirements.txt
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Flask==3.0.0
flask-cors==4.0.0
requests==2.31.0
python-dateutil==2.8.2
google-generativeai==0.3.1
gunicorn==23.0.0


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FILE: manifest.json
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

{
  "name": "FlintWeatherAI",
  "short_name": "FlintWeather",
  "description": "Smart AI-powered weather forecasting application",
  "start_url": "/",
  "display": "standalone",
  "background_color": "#7c3aed",
  "theme_color": "#7c3aed",
  "orientation": "portrait-primary",
  "icons": [
    {
      "src": "/static/images/icon-192.png",
      "sizes": "192x192",
      "type": "image/png",
      "purpose": "any maskable"
    },
    {
      "src": "/static/images/icon-512.png",
      "sizes": "512x512",
      "type": "image/png",
      "purpose": "any maskable"
    }
  ],
  "categories": ["weather", "utilities"],
  "screenshots": [],
  "shortcuts": [
    {
      "name": "Current Weather",
      "url": "/?view=current",
      "description": "View current weather conditions"
    },
    {
      "name": "7-Day Forecast",
      "url": "/?view=forecast",
      "description": "View 7-day weather forecast"
    }
  ]
}


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FILE: render.yaml
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

services:
  - type: web
    name: flintweatherai
    env: python
    buildCommand: pip install -r requirements.txt
    startCommand: gunicorn --workers=2 --timeout=120 --bind=0.0.0.0:$PORT app.main:app
    envVars:
      - key: PYTHON_VERSION
        value: 3.10.13
      - key: GEMINI_API_KEY
        value: AIzaSyDQ5xYoZurnsQ7w-sW28pTgPU8IeBH2q3g
      - key: WEATHER_API_KEY
        value: b010b4bbd1524f6c92c192501251111

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FILE: start_server.sh
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

#!/data/data/com.termux/files/usr/bin/bash

echo "=========================================="
echo "  ğŸŒ¤ï¸  FlintWeatherAI Server Startup"
echo "=========================================="
echo ""

cd ~/weather/FlintWeatherAI || exit 1

if ! command -v python &> /dev/null; then
    echo "âŒ Python not found!"
    exit 1
fi

echo "ğŸ Python: $(python --version)"
echo ""

echo "ğŸ“¦ Checking dependencies..."
python -c "import flask, requests, google.generativeai" 2>/dev/null
if [ $? -eq 0 ]; then
    echo "âœ… All dependencies installed"
else
    echo "âŒ Missing dependencies!"
    echo "Install with: pip install -r requirements.txt"
    exit 1
fi

echo ""
echo "ğŸ“ Checking project structure..."
required_files=(
    "config/__init__.py"
    "config/config.py"
    "utils/__init__.py"
    "utils/cache.py"
    "utils/weather.py"
    "utils/free_weather_apis.py"
    "utils/free_ai_apis.py"
    "app/main.py"
    "templates/index.html"
    "static/css/style.css"
    "static/js/app.js"
)

missing_files=0
for file in "${required_files[@]}"; do
    if [ ! -f "$file" ]; then
        echo "âŒ Missing: $file"
        missing_files=$((missing_files + 1))
    fi
done

if [ $missing_files -gt 0 ]; then
    echo ""
    echo "âŒ $missing_files required file(s) missing!"
    exit 1
fi

echo "âœ… All required files present"
echo ""

echo "ğŸŒ Network Information:"
echo "   Local:   http://localhost:8000"
ip_addr=$(ifconfig 2>/dev/null | grep -oP 'inet K[d.]+' | grep -v '127.0.0.1' | head -1)
if [ -n "$ip_addr" ]; then
    echo "   Network: http://$ip_addr:8000"
fi
echo ""

echo "ğŸš€ Starting FlintWeatherAI..."
echo "=========================================="
echo ""
echo "Press Ctrl+C to stop the server"
echo ""

python app/main.py

echo ""
echo "Server stopped."


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FILE: generate_project_dump.sh
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

#!/bin/bash

OUTPUT_FILE="FlintWeatherAI_project_dump.txt"
PROJECT_NAME="FlintWeatherAI"
PROJECT_ROOT=$(pwd)

echo "=========================================="
echo "Universal Project Dumper v2.0"
echo "=========================================="
echo "Project: $PROJECT_NAME"
echo "Location: $PROJECT_ROOT"
echo ""

# Start the dump file
cat > "$OUTPUT_FILE" << EOF
================================================================================
                         PROJECT CODE DUMP: $PROJECT_NAME
================================================================================

Project Name: $PROJECT_NAME
Project Root: $PROJECT_ROOT
Generated: $(date '+%Y-%m-%d %H:%M:%S')
Generated by: Universal Project Dumper v2.0

================================================================================
                              TABLE OF CONTENTS
================================================================================

1. Project File Structure (Tree View)
2. Project Statistics
3. All Code Files (with full content)

================================================================================

EOF

# Add tree structure
echo "Generating file structure..."
echo "================================================================================" >> "$OUTPUT_FILE"
echo "                           1. PROJECT FILE STRUCTURE (Tree View)" >> "$OUTPUT_FILE"
echo "================================================================================" >> "$OUTPUT_FILE"
echo "" >> "$OUTPUT_FILE"
tree -I 'venv|__pycache__|*.pyc|node_modules' >> "$OUTPUT_FILE" 2>/dev/null || find . -not -path '*/venv/*' -not -path '*/__pycache__/*' -not -name '*.pyc' >> "$OUTPUT_FILE"
echo "" >> "$OUTPUT_FILE"

# Statistics
echo "Calculating project statistics..."
echo "================================================================================" >> "$OUTPUT_FILE"
echo "                              2. PROJECT STATISTICS" >> "$OUTPUT_FILE"
echo "================================================================================" >> "$OUTPUT_FILE"
echo "" >> "$OUTPUT_FILE"

PYTHON_FILES=$(find . -name "*.py" -not -path "*/venv/*" -not -path "*/__pycache__/*" | wc -l)
JS_FILES=$(find . -name "*.js" -not -path "*/venv/*" -not -path "*/node_modules/*" | wc -l)
HTML_FILES=$(find . -name "*.html" -not -path "*/venv/*" | wc -l)
CSS_FILES=$(find . -name "*.css" -not -path "*/venv/*" | wc -l)
TOTAL_FILES=$(find . -type f -not -path "*/venv/*" -not -path "*/__pycache__/*" -not -name "*.pyc" | wc -l)

echo "File Count by Extension:" >> "$OUTPUT_FILE"
echo "  .py files:    $PYTHON_FILES" >> "$OUTPUT_FILE"
echo "  .js files:    $JS_FILES" >> "$OUTPUT_FILE"
echo "  .html files:  $HTML_FILES" >> "$OUTPUT_FILE"
echo "  .css files:   $CSS_FILES" >> "$OUTPUT_FILE"
echo "  Total files:  $TOTAL_FILES" >> "$OUTPUT_FILE"
echo "" >> "$OUTPUT_FILE"

# Dump all code files
echo "Dumping all code files..."
echo "================================================================================" >> "$OUTPUT_FILE"
echo "                           3. ALL CODE FILES (Full Content)" >> "$OUTPUT_FILE"
echo "================================================================================" >> "$OUTPUT_FILE"
echo "" >> "$OUTPUT_FILE"

FILE_COUNT=0

# Function to dump a file
dump_file() {
    local file="$1"
    local rel_path="${file#./}"
    
    echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" >> "$OUTPUT_FILE"
    echo "FILE: $rel_path" >> "$OUTPUT_FILE"
    echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" >> "$OUTPUT_FILE"
    echo "" >> "$OUTPUT_FILE"
    cat "$file" >> "$OUTPUT_FILE" 2>/dev/null || echo "[Binary or unreadable file]" >> "$OUTPUT_FILE"
    echo "" >> "$OUTPUT_FILE"
    echo "" >> "$OUTPUT_FILE"
    ((FILE_COUNT++))
}

# Dump Python files
find . -name "*.py" -not -path "*/venv/*" -not -path "*/__pycache__/*" -type f | while read file; do
    dump_file "$file"
done

# Dump JS files
find . -name "*.js" -not -path "*/venv/*" -not -path "*/node_modules/*" -type f | while read file; do
    dump_file "$file"
done

# Dump HTML files
find . -name "*.html" -not -path "*/venv/*" -type f | while read file; do
    dump_file "$file"
done

# Dump CSS files
find . -name "*.css" -not -path "*/venv/*" -type f | while read file; do
    dump_file "$file"
done

# Dump config files
for ext in txt json yaml yml sh md; do
    find . -maxdepth 2 -name "*.$ext" -not -name "$OUTPUT_FILE" -type f | while read file; do
        dump_file "$file"
    done
done

echo "================================================================================" >> "$OUTPUT_FILE"
echo "                              END OF PROJECT DUMP" >> "$OUTPUT_FILE"
echo "================================================================================" >> "$OUTPUT_FILE"

# Final statistics
OUTPUT_SIZE=$(du -h "$OUTPUT_FILE" | cut -f1)

echo ""
echo "âœ… Project dump completed successfully!"
echo ""
echo "ğŸ“Š Statistics:"
echo "  - Files processed: $FILE_COUNT"
echo "  - Output file: $PROJECT_ROOT/$OUTPUT_FILE"
echo "  - File size: $OUTPUT_SIZE"
echo ""
echo "ğŸ“„ View the dump:"
echo "  less $PROJECT_ROOT/$OUTPUT_FILE"
echo "  nano $PROJECT_ROOT/$OUTPUT_FILE"
echo ""
echo "=========================================="


================================================================================
                              END OF PROJECT DUMP
================================================================================
